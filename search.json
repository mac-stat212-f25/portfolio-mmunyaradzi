[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "COMP/STAT212 Portfolio",
    "section": "",
    "text": "Welcome\nWelcome to my online portfolio for COMP/STAT112 course taken at Macalester College. Please, use the side bar on the left for navigation.",
    "crumbs": [
      "Welcome"
    ]
  },
  {
    "objectID": "src/pv/pv-01.html",
    "href": "src/pv/pv-01.html",
    "title": "Professional Viz Sample",
    "section": "",
    "text": "Code#packages\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(readr)\nlibrary(plotly)\nlibrary(sf)\nlibrary(viridis)\n\n\nHow did Crime fare by Province in South Africa from 2015 to 2016?\nSouth Africa, with its diverse landscapes and complex social history, has long grappled with issues of crime that impact public safety, economic development, and community well-being. This solo project aims to visualize the distribution of crime across South Africa‚Äôs provinces during the 2015‚Äì2016 fiscal year using spatial data analysis and data visualization.\nObjective:\nThe primary objective of this research is to provide a clear, intuitive map-based representation of total reported crimes by province.\n\nCode# data\ncrime &lt;- read_csv(\"../../data/raw/SouthAfricaCrimeStats_v2.csv\")\n\n\n# shape file\nmap_data &lt;- st_read(\"../../data/raw/south_africa_Province_level_1_MAPOG/south_africa_Province_level_1.shp\")\n\nReading layer `south_africa_Province_level_1' from data source \n  `/Users/munyaradzi/Desktop/STAT212/portfolio_mmunyaradzi/data/raw/south_africa_Province_level_1_MAPOG/south_africa_Province_level_1.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 9 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 16.45189 ymin: -34.83417 xmax: 32.94498 ymax: -22.12503\nGeodetic CRS:  WGS 84\n\n\n\nCode# increase spread by log transformation\ncrime_filtered &lt;- crime %&gt;%\n  select(Province, `2015-2016`) %&gt;%\n  mutate(`2015-2016` = as.numeric(`2015-2016`))\n\n\n\nCode# Inspect data\nhead(map_data)\n\nSimple feature collection with 6 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 22.73574 ymin: -34.21386 xmax: 32.94498 ymax: -22.12503\nGeodetic CRS:  WGS 84\n         shape1 shapeiso                 shapeid shapegroup shapetype\n1  Eastern Cape       EC 76434192B98113213215773        ZAF      ADM1\n2    Free State       FS 76434192B57942368908249        ZAF      ADM1\n3       Gauteng       GT 76434192B69392740373411        ZAF      ADM1\n4 KwaZulu-Natal       KZ 76434192B26311534340602        ZAF      ADM1\n5       Limpopo       LI 76434192B37104984973577        ZAF      ADM1\n6    Mpumalanga       MP 76434192B92524600968894        ZAF      ADM1\n        shape0                       geometry\n1 south africa MULTIPOLYGON (((30.19386 -3...\n2 south africa MULTIPOLYGON (((27.37735 -3...\n3 south africa MULTIPOLYGON (((28.24428 -2...\n4 south africa MULTIPOLYGON (((30.19386 -3...\n5 south africa MULTIPOLYGON (((28.65157 -2...\n6 south africa MULTIPOLYGON (((29.75868 -2...\n\nCodehead(crime)\n\n# A tibble: 6 √ó 14\n  Province     Station  Category `2005-2006` `2006-2007` `2007-2008` `2008-2009`\n  &lt;chr&gt;        &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;\n1 Western Cape Cape To‚Ä¶ All the‚Ä¶        6692        6341        5966        5187\n2 Gauteng      Jhb Cen‚Ä¶ All the‚Ä¶        6093        4602        3761        3610\n3 Western Cape Mitchel‚Ä¶ All the‚Ä¶        5341        6093        6316        6803\n4 Free State   Park Ro‚Ä¶ All the‚Ä¶        5108        4282        3834        3316\n5 Gauteng      Pretori‚Ä¶ All the‚Ä¶        5099        4536        3309        2694\n6 North West   Rustenb‚Ä¶ All the‚Ä¶        4239        4173        3398        3388\n# ‚Ñπ 7 more variables: `2009-2010` &lt;dbl&gt;, `2010-2011` &lt;dbl&gt;, `2011-2012` &lt;dbl&gt;,\n#   `2012-2013` &lt;dbl&gt;, `2013-2014` &lt;dbl&gt;, `2014-2015` &lt;dbl&gt;, `2015-2016` &lt;dbl&gt;\n\n\n\nCode# group by province and create a sum for the entries\ncrime_filtered &lt;- crime %&gt;%\n  group_by(Province) %&gt;%\n  summarise(`2015-2016` = sum(as.numeric(`2015-2016`))) \n\n# Standardize province names and lowercase & remove extra spaces\ncrime_filtered &lt;- crime_filtered %&gt;%\n  mutate(Province = tolower(trimws(Province))) \n\n# correct KwaZulu-Natal Kwazulu/Natal mismatch\ncrime_filtered &lt;- crime_filtered %&gt;%\n  mutate(Province = ifelse(Province == \"kwazulu-natal\", \"kwazulu/natal\", Province))\n\n# rename shape1 to province\nmap_data &lt;- map_data %&gt;%\n  rename(Province = shape1) %&gt;%\n  mutate(Province = tolower(trimws(Province)))\n\n\n\nCode# join the csv and the shape file\nmap_data &lt;- map_data %&gt;%\n  left_join(crime_filtered, by = \"Province\")\n\n\n\nCode# plot\nlibrary(ggplot2)\n\nggplot() +\n  geom_sf(data = map_data, aes(fill = `2015-2016`), color = \"white\", size = 0.15) +\n  scale_fill_viridis_c(option = \"plasma\", na.value = \"red\") +\n  labs(\n    title = \"Total Crime Cases in South Africa (2015-2016)\",\n    fill = \"Cases\",\n    caption = \"Source: South African Police Service (SAPS)\"\n  ) +\n  theme_void()\n\n\n\n\n\n\n\nResults\nThe resulting map visually emphasizes disparities in crime totals across provinces:\n\nGauteng, Western Cape, Northen and KwaZulu-Natal (most of which are densely populated provinces) appear to have higher crime totals, possibly reflecting both population density and urban challenges.\nOn the other side of the spectrum we have Free State, North West Province, Limpopo and Mpumalanga; most of which are sparsely populated areas with relatively lower crime totals, though this does not necessarily imply safety, as underreporting and other factors might influence statistics",
    "crumbs": [
      "Prof Viz",
      "<span class='chapter-number'>1</span>¬† <span class='chapter-title'>Professional Viz Sample</span>"
    ]
  },
  {
    "objectID": "src/exam/exam.html",
    "href": "src/exam/exam.html",
    "title": "Exam",
    "section": "",
    "text": "Research question: How is petal length related to petal width across iris species?\n\nCode#install.packages(\"ggvis\")\n#install.packages(\"shiny)\nlibrary(shiny)\nlibrary(ggvis)\nlibrary(dplyr)\n\n\n\nCodedata(iris)\n\niris %&gt;%\n  ggvis(~Petal.Length, ~Petal.Width, fill = ~Species) %&gt;%\n  layer_points() %&gt;%\n  add_axis(\"x\", title = \"Petal Length (cm)\") %&gt;%\n  add_axis(\"y\", title = \"Petal Width (cm)\") %&gt;%\n  add_tooltip(function(df) {\n    paste0(\n      \"Species: \", df$Species, \"&lt;br&gt;\",\n      \"Petal Length: \", df$Petal.Length, \" cm&lt;br&gt;\",\n      \"Petal Width: \", df$Petal.Width, \" cm\"\n    )\n  }, \"hover\") %&gt;%\n  set_options(width = 600, height = 400)\n\n\n\n\n\n\n\nRenderer: \nSVG\n | \nCanvas\n\n\nDownload\n\n\n\n\n\n\n\n\nThe scatter plot shows a clear positive relationship between petal length and petal width in the iris data, with longer petals generally associated with wider petals. The three color groups form distinct clusters, indicating that species differ markedly in their petal dimensions and occupy largely separate regions of the plot. This separation suggests that petal size is a strong morphological characteristic that can help distinguish between iris species.",
    "crumbs": [
      "Exam",
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Exam</span>"
    ]
  },
  {
    "objectID": "src/tt/hw01-tt.html",
    "href": "src/tt/hw01-tt.html",
    "title": "Homework 01",
    "section": "",
    "text": "TidyTuesday Section\nExplore the week‚Äôs TidyTuesday challenge. Develop a research question, then answer it through a short data story with effective visualization(s). Provide sufficient background for readers to grasp your narrative.",
    "crumbs": [
      "TidyTuesday",
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Homework 01</span>"
    ]
  },
  {
    "objectID": "src/tt/hw01-tt.html#research-question-how-are-frog-species-occurrences-distributed-across-australian-states",
    "href": "src/tt/hw01-tt.html#research-question-how-are-frog-species-occurrences-distributed-across-australian-states",
    "title": "Homework 01",
    "section": "Research Question: How are frog species occurrences distributed across Australian states?‚Äù",
    "text": "Research Question: How are frog species occurrences distributed across Australian states?‚Äù\n\nCode# Using R\n# Option 1: tidytuesdayR R package \n# install.packages(\"tidytuesdayR\")\n\ntuesdata &lt;- tidytuesdayR::tt_load('2025-09-02')\n## OR\n#tuesdata &lt;- tidytuesdayR::tt_load(2025, week = 35)\n\nfrogID_data &lt;- tuesdata$frogID_data\nfrog_names &lt;- tuesdata$frog_names\n\n# Option 2: Read directly from GitHub\n\nfrogID_data &lt;- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-09-02/frogID_data.csv')\nfrog_names &lt;- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-09-02/frog_names.csv')\n\n\n\nCode#View(frogID_data)\n\n\n\nCodelibrary(ggplot2)\n\nggplot(frogID_data, aes(x = stateProvince, fill = stateProvince)) +\n  geom_bar() +\n  labs(title = \"Number of Frog Occurrences by State\",\n       x = \"State/Province\", y = \"Count\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 70, hjust = 1))\n\n\n\n\n\n\n\n\nLooking at the bar chart of frog occurrences by state, it is clear that frog records are unevenly distributed across Australia. New South Wales has by far the highest number of occurrences, with close to 60,000 records, followed by Victoria and Queensland (32000 and 21000 respectively) , which also show substantial numbers of observations. Other states, such as South Australia, Tasmania, and the Australian Capital Territory, contribute far fewer records, while the Northern Territory and Other Territories have very limited observations.",
    "crumbs": [
      "TidyTuesday",
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Homework 01</span>"
    ]
  },
  {
    "objectID": "src/ica/cleaning.html",
    "href": "src/ica/cleaning.html",
    "title": "Cleaning SFO Weather Data",
    "section": "",
    "text": "Exercise\nCarryout the following steps to clean and save the San Francisco Weather data. Make sure to download and add the data file to your portfolio repository as instructed.\nCode# Load packages and read in data.\nlibrary(tidyverse)\nweather &lt;- read_csv(\"../../data/raw/weather.csv\")\n\n\n#view(weather)\n#head(weather)\nCode# Clean the PrecipYr by replacing 99999 with NA.\nweather_clean &lt;- weather |&gt; \n  mutate(PrecipYr = na_if(PrecipYr,99999))\n\n\n#view(weather_clean)\nCode# Add dateInYear variable.\n\nweather_clean &lt;- weather_clean |&gt; \n    arrange(Month, Day) |&gt; \n    mutate(dateInYear = 1:365)\nCode#. Add in 3-letter month abbreviations.\n# Option 1: via joins\nmonths &lt;- tibble(\n    Month = 1:12,\n    month_name = month.abb\n)\nweather_clean &lt;- weather_clean |&gt; \n    left_join(months)\n\n# Option 2: via vector subsetting\n##    mutate(month_name = month.abb[Month]) |&gt; head()\nCode# Write out clean data to a CSV file.\nwrite_csv(weather_clean, file = \"../../data/processed/weather_clean.csv\")",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>Cleaning SFO Weather Data</span>"
    ]
  },
  {
    "objectID": "src/ica/cleaning.html#exercise",
    "href": "src/ica/cleaning.html#exercise",
    "title": "Cleaning SFO Weather Data",
    "section": "",
    "text": "Read in the weather data in this file with the correct relative file path after you move it to the instructed location.\nThere is a variable that has values that don‚Äôt make sense in the data context. Figure out which variable this is and clean it up by making those values missing using na_if().\nCreate a variable called dateInYear that indicates the day of the year (1-365) for each case. (Jan 1 should be 1, and Dec 31 should be 365).\nCreate a variable called month_name that shows the 3-letter abbreviation for each case.\nSave the wrangled data to the data/processed/ folder using write_csv(). Name this file weather_clean.csv. Look up the documentation for this function by typing ?write_csv in the Console. You‚Äôll need to write an appropriate relative path.",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>Cleaning SFO Weather Data</span>"
    ]
  },
  {
    "objectID": "src/ica/03-adv-ggplot-notes.html",
    "href": "src/ica/03-adv-ggplot-notes.html",
    "title": "3 Advanced Data Viz",
    "section": "",
    "text": "üß© Learning Goals\nBy the end of this lesson, you should be able to:",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>3 Advanced Data Viz</span>"
    ]
  },
  {
    "objectID": "src/ica/03-adv-ggplot-notes.html#learning-goals",
    "href": "src/ica/03-adv-ggplot-notes.html#learning-goals",
    "title": "3 Advanced Data Viz",
    "section": "",
    "text": "Navigate ggplot2 reference page to find needed functions for a desired visualization\nNavigate the different sections of a function help page to construct desired plot features, in particular,\n\nNavigate the Usage section to identify arguments that must be set\nNavigate the Arguments section to understand how arguments work\nNavigate the Aesthetics section to learn how plot appearance can be controlled\nNavigate the Examples section for some usage examples\n\n\nIdentify when to use different data arguments within ggplot() and geom_() layers",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>3 Advanced Data Viz</span>"
    ]
  },
  {
    "objectID": "src/ica/03-adv-ggplot-notes.html#introduction",
    "href": "src/ica/03-adv-ggplot-notes.html#introduction",
    "title": "3 Advanced Data Viz",
    "section": "Introduction 1\n",
    "text": "Introduction 1\n\nIn this lesson, we are going to recreate NYTimes 2015 Temperature Visualization (html) using data from San Francisco (SFO) in 2011.\n\n\nScreenshot of NYTimes 2015 Temperature Visualization",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>3 Advanced Data Viz</span>"
    ]
  },
  {
    "objectID": "src/ica/03-adv-ggplot-notes.html#reading-data",
    "href": "src/ica/03-adv-ggplot-notes.html#reading-data",
    "title": "3 Advanced Data Viz",
    "section": "Reading Data",
    "text": "Reading Data\nRun the code chunk below to load the tidyverse package and read in the San Francisco weather data.\n\nCodelibrary(tidyverse)\nweather &lt;- read_csv(\"https://mac-stat.github.io/data/sfo_weather.csv\")\n\n#View(weather)",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>3 Advanced Data Viz</span>"
    ]
  },
  {
    "objectID": "src/ica/03-adv-ggplot-notes.html#understanding-data",
    "href": "src/ica/03-adv-ggplot-notes.html#understanding-data",
    "title": "3 Advanced Data Viz",
    "section": "Understanding Data",
    "text": "Understanding Data\nBelow is the codebook of the data. Familiarize yourself with the meaning of each variable. Use the codebook as a reference when using the data.\n\n\nMonth: Month of the year (1-12)\n\nDay: Day within the month (1-31)\n\nLow/High: Low/high temperature this day\n\nNormalLow/NormalHigh: Typical low/high temperature for this day of the year\n\nRecordLow/RecordHigh: Record low/high temperature for this day of the year\n\nLowYr/HighYr: Year in which the record low/high was observed\n\nPrecip: Amount of precipitation (inches) this day\n\nRecordPrecip: Record amount of precipitation for this day of the year\n\nPrecipYr: Year in which the record precipitation was observed\n\ndate: The actual date in 2011 for this day in YYYY-MM-DD format\n\ndateInYear: What day of the year is it? (1-365)\n\nRecord: Logical (TRUE/FALSE) indicating whether this day had a high temperature record\n\nRecordText: Text that displays the record high for this day (\"Record high: ##\")\n\nRecordP: Logical (TRUE/FALSE) indicating whether this day had a precipitation record\n\nCulmPrec: Cumulative precipitation for the month up to this day",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>3 Advanced Data Viz</span>"
    ]
  },
  {
    "objectID": "src/ica/03-adv-ggplot-notes.html#exercise-1",
    "href": "src/ica/03-adv-ggplot-notes.html#exercise-1",
    "title": "3 Advanced Data Viz",
    "section": "Exercise 1",
    "text": "Exercise 1\nExamine the NYTimes 2015 Temperature Visualization (html) then answer the following questions.\nData Storytelling\n\nRelate the intro paragraph: ‚ÄúScientists declared that 2015 was Earth‚Äôs hottest year on record‚Ä¶‚Äù to the design of the visualization. In particular, based on the intro paragraph,\n\nWhat key message/claim does NYTimes want readers to be able to explore?\n\n\nexploring how warm cities were hot/warmer in 2015\n\n\nHow did this goal inform what information is displayed in the visualization?\n\n\nvariables linked to the exploration temperature, temp range, months\n\n\n\nAesthetic Mapping\n\nWhat specific variables (from the data codebook) underlie the visualization?\nHow do these variables map to aesthetics of the visual elements, eg, position, size, shape, and color of glyphs?\n\n\ntemp, range, months",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>3 Advanced Data Viz</span>"
    ]
  },
  {
    "objectID": "src/ica/03-adv-ggplot-notes.html#exercise-2",
    "href": "src/ica/03-adv-ggplot-notes.html#exercise-2",
    "title": "3 Advanced Data Viz",
    "section": "Exercise 2",
    "text": "Exercise 2\nNavigate the Geoms section of the ggplot2 reference page to find a geom that corresponds to the visual elements in the temperature plot. Using both the small thumbnail visuals on the right and the names of the geom‚Äôs, brainstorm some possibilities for geom‚Äôs you might use to recreate the temperature visualization.\n\ngeom_ribbon\n\n\n\n\n\n\n\nNavigating Documentation / Reference Pages\n\n\n\nYou need to navigate the geoms further by opening up their reference pages to understand if a particular geom is suitable for our task. Let‚Äôs look at the geom_point documentation page to learn how to read a documentation page..\nThe Usage section shows all of the possible inputs (arguments) to the geom. These are all of the ways that a geom can be customized. Just looking at the argument names can help give a hint as to what arguments might fit our needs.\nThe Arguments section, on the other hand, explains in detail what each argument does and the possible values the argument can take. The mapping, data, and ... arguments will be the most commonly used by far.\n\n\nmapping is the argument that is being used when we specify which variables should link or map to the plot aesthetics (the code inside aes()).\n\ndata is the argument where we specify the dataset containing the variables that the geom is using.\n\n... is used for fixed aesthetics (ones that don‚Äôt correspond to a variable), eg, to set the color of all points, we use color = \"red\" and to set the size of all points, we use size = 3.\n\nThe Aesthetics section of a geom documentation page gives information on how the visual elements of the geom correspond to data. For example, the geom_point documentation page shows that x and y aesthetics are available. It also shows some new aesthetics like stroke.\n\n\n\n\n\n\n\n\ndata Argument\n\n\n\nPreviously you have used one dataset per plot by specifying that as the first argument of ggplot(). However, multiple data sets can be passed into ggplot as shown in the example below.\n\nCodedata(diamonds)\n\ndiamonds_avg_price &lt;- diamonds |&gt;\n  group_by(carat) |&gt;\n  summarize(avg_price = mean(price)) |&gt;\n  arrange(carat)\ndiamonds_avg_price &lt;- diamonds_avg_price[seq(1, nrow(diamonds_avg_price), 3), ]\n\nggplot(diamonds, aes(x = carat, y = price)) +\n  geom_point() +\n  geom_point(\n    data = diamonds_avg_price,\n    aes(x = carat, y = avg_price),\n    color = \"deepskyblue\",\n    size = 3\n  )\n\n\n\n\n\n\n\n\n\nLook at the geom_linerange documentation page and start off your temperature visualization with the record lows and highs. Your plot should look like the one below. The hex code of the used light tan color is #ECEBE3.\n\n\nSFO Weather Records in 2011\n\n\nCodelibrary(gridExtra)\n\nggplot(weather) +\n    theme_classic()\n\n\n\n\n\n\n\n\n\n\n\n\n\nKeyboard Shortcuts\n\n\n\nAs you work on this plot, try to use some new keyboard shortcuts. Focus on the following:\n\nInsert code chunk: Ctrl+Alt+I (Windows). Option+Command+I (Mac).\nRun current code chunk: Ctrl+Shift+Enter (Windows). Command+Shift+Return (Mac).\nRun current line/currently selected lines: Ctrl+Enter (Windows). Command+Return (Mac).",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>3 Advanced Data Viz</span>"
    ]
  },
  {
    "objectID": "src/ica/03-adv-ggplot-notes.html#exercise-3",
    "href": "src/ica/03-adv-ggplot-notes.html#exercise-3",
    "title": "3 Advanced Data Viz",
    "section": "Exercise 3",
    "text": "Exercise 3\nIn your visualization, also display the usual temperatures (NormalLow and NormalHigh) and actual 2011 temperatures (Low and High). Your plot should look like the one below. The hex code of the color used for the usual temperatures is \"#C8B8BA\" and for the color used for actual temperatures is \"#A90248\".\n\n\nSFO observed, Average, and Record Daily Temperatures in 2011\n\n\nCodeweather_month &lt;- weather %&gt;%\ngroup_by(Month)%&gt;%\n  filter(Day == max(Day))\n\nweather_record_temp &lt;- weather %&gt;% filter(Record == TRUE)\nweather_record_precip &lt;- weather %&gt;% filter(RecordP == TRUE)\n\nweather_precip_summary &lt;- weather %&gt;%\ngroup_by(Month) %&gt;%\nsummarise(total_precip = max(CulmPrec))\n\n## Visualization\n\n\n# Code for recreating the visualization\n# Use as many code chunks as you need to organize your work well\n\n\nweather_month &lt;- weather %&gt;%\ngroup_by(Month)%&gt;%\n  filter(Day == max(Day))\n\nweather_record_temp &lt;- weather %&gt;% filter(Record == TRUE)\nweather_record_precip &lt;- weather %&gt;% filter(RecordP == TRUE)\n\nweather_precip_summary &lt;- weather %&gt;%\ngroup_by(Month) %&gt;%\nsummarise(total_precip = max(CulmPrec))\n\n\n\nCode# Temperature Plot\ntempplot &lt;- ggplot(weather) +\n    geom_linerange(aes(x = dateInYear, ymin = RecordLow, ymax = RecordHigh), color = \"#ecebe3\", linewidth = 1.5) +  \n  geom_linerange(aes(x = dateInYear, ymin = NormalLow, ymax = NormalHigh), color = \"#C8B8BA\", linewidth = 1.5) +  \n  geom_linerange(aes(x = dateInYear, ymin = Low, ymax = High), color = \"#A90248\", linewidth = 1.5) + \ngeom_vline(data = weather_month, aes(xintercept = dateInYear), linetype = 'dotted', color = 'grey70') +\ngeom_point(data = weather_record_temp, aes(x = dateInYear, y = High), shape = 25, fill = \"black\", color = \"black\", size = 2) +\ngeom_text(data = weather_record_temp, aes(x = dateInYear, y = High, label = RecordText), vjust = -1, hjust = -0.1, size = 3, angle = 0) + \nscale_x_continuous(breaks = seq(15, 365, by = 30), labels = month.abb) +\n  scale_y_continuous(breaks = c(0, 40, 80, 120), limits = c(0, 120)) +\n  \nlabs(title = \"Temperature.    SFO weather in 2011\", y = \"\", x = \"\")\ntheme_classic() \n\nList of 136\n $ line                            :List of 6\n  ..$ colour       : chr \"black\"\n  ..$ linewidth    : num 0.5\n  ..$ linetype     : num 1\n  ..$ lineend      : chr \"butt\"\n  ..$ arrow        : logi FALSE\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_line\" \"element\"\n $ rect                            :List of 5\n  ..$ fill         : chr \"white\"\n  ..$ colour       : chr \"black\"\n  ..$ linewidth    : num 0.5\n  ..$ linetype     : num 1\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_rect\" \"element\"\n $ text                            :List of 11\n  ..$ family       : chr \"\"\n  ..$ face         : chr \"plain\"\n  ..$ colour       : chr \"black\"\n  ..$ size         : num 11\n  ..$ hjust        : num 0.5\n  ..$ vjust        : num 0.5\n  ..$ angle        : num 0\n  ..$ lineheight   : num 0.9\n  ..$ margin       : 'margin' num [1:4] 0points 0points 0points 0points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : logi FALSE\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ title                           : NULL\n $ aspect.ratio                    : NULL\n $ axis.title                      : NULL\n $ axis.title.x                    :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : NULL\n  ..$ vjust        : num 1\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : 'margin' num [1:4] 2.75points 0points 0points 0points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.title.x.top                :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : NULL\n  ..$ vjust        : num 0\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : 'margin' num [1:4] 0points 0points 2.75points 0points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.title.x.bottom             : NULL\n $ axis.title.y                    :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : NULL\n  ..$ vjust        : num 1\n  ..$ angle        : num 90\n  ..$ lineheight   : NULL\n  ..$ margin       : 'margin' num [1:4] 0points 2.75points 0points 0points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.title.y.left               : NULL\n $ axis.title.y.right              :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : NULL\n  ..$ vjust        : num 1\n  ..$ angle        : num -90\n  ..$ lineheight   : NULL\n  ..$ margin       : 'margin' num [1:4] 0points 0points 0points 2.75points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.text                       :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : chr \"grey30\"\n  ..$ size         : 'rel' num 0.8\n  ..$ hjust        : NULL\n  ..$ vjust        : NULL\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : NULL\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.text.x                     :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : NULL\n  ..$ vjust        : num 1\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : 'margin' num [1:4] 2.2points 0points 0points 0points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.text.x.top                 :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : NULL\n  ..$ vjust        : num 0\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : 'margin' num [1:4] 0points 0points 2.2points 0points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.text.x.bottom              : NULL\n $ axis.text.y                     :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : num 1\n  ..$ vjust        : NULL\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : 'margin' num [1:4] 0points 2.2points 0points 0points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.text.y.left                : NULL\n $ axis.text.y.right               :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : num 0\n  ..$ vjust        : NULL\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : 'margin' num [1:4] 0points 0points 0points 2.2points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.text.theta                 : NULL\n $ axis.text.r                     :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : num 0.5\n  ..$ vjust        : NULL\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : 'margin' num [1:4] 0points 2.2points 0points 2.2points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.ticks                      :List of 6\n  ..$ colour       : chr \"grey20\"\n  ..$ linewidth    : NULL\n  ..$ linetype     : NULL\n  ..$ lineend      : NULL\n  ..$ arrow        : logi FALSE\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_line\" \"element\"\n $ axis.ticks.x                    : NULL\n $ axis.ticks.x.top                : NULL\n $ axis.ticks.x.bottom             : NULL\n $ axis.ticks.y                    : NULL\n $ axis.ticks.y.left               : NULL\n $ axis.ticks.y.right              : NULL\n $ axis.ticks.theta                : NULL\n $ axis.ticks.r                    : NULL\n $ axis.minor.ticks.x.top          : NULL\n $ axis.minor.ticks.x.bottom       : NULL\n $ axis.minor.ticks.y.left         : NULL\n $ axis.minor.ticks.y.right        : NULL\n $ axis.minor.ticks.theta          : NULL\n $ axis.minor.ticks.r              : NULL\n $ axis.ticks.length               : 'simpleUnit' num 2.75points\n  ..- attr(*, \"unit\")= int 8\n $ axis.ticks.length.x             : NULL\n $ axis.ticks.length.x.top         : NULL\n $ axis.ticks.length.x.bottom      : NULL\n $ axis.ticks.length.y             : NULL\n $ axis.ticks.length.y.left        : NULL\n $ axis.ticks.length.y.right       : NULL\n $ axis.ticks.length.theta         : NULL\n $ axis.ticks.length.r             : NULL\n $ axis.minor.ticks.length         : 'rel' num 0.75\n $ axis.minor.ticks.length.x       : NULL\n $ axis.minor.ticks.length.x.top   : NULL\n $ axis.minor.ticks.length.x.bottom: NULL\n $ axis.minor.ticks.length.y       : NULL\n $ axis.minor.ticks.length.y.left  : NULL\n $ axis.minor.ticks.length.y.right : NULL\n $ axis.minor.ticks.length.theta   : NULL\n $ axis.minor.ticks.length.r       : NULL\n $ axis.line                       :List of 6\n  ..$ colour       : chr \"black\"\n  ..$ linewidth    : 'rel' num 1\n  ..$ linetype     : NULL\n  ..$ lineend      : NULL\n  ..$ arrow        : logi FALSE\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_line\" \"element\"\n $ axis.line.x                     : NULL\n $ axis.line.x.top                 : NULL\n $ axis.line.x.bottom              : NULL\n $ axis.line.y                     : NULL\n $ axis.line.y.left                : NULL\n $ axis.line.y.right               : NULL\n $ axis.line.theta                 : NULL\n $ axis.line.r                     : NULL\n $ legend.background               :List of 5\n  ..$ fill         : NULL\n  ..$ colour       : logi NA\n  ..$ linewidth    : NULL\n  ..$ linetype     : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_rect\" \"element\"\n $ legend.margin                   : 'margin' num [1:4] 5.5points 5.5points 5.5points 5.5points\n  ..- attr(*, \"unit\")= int 8\n $ legend.spacing                  : 'simpleUnit' num 11points\n  ..- attr(*, \"unit\")= int 8\n $ legend.spacing.x                : NULL\n $ legend.spacing.y                : NULL\n $ legend.key                      : NULL\n $ legend.key.size                 : 'simpleUnit' num 1.2lines\n  ..- attr(*, \"unit\")= int 3\n $ legend.key.height               : NULL\n $ legend.key.width                : NULL\n $ legend.key.spacing              : 'simpleUnit' num 5.5points\n  ..- attr(*, \"unit\")= int 8\n $ legend.key.spacing.x            : NULL\n $ legend.key.spacing.y            : NULL\n $ legend.frame                    : NULL\n $ legend.ticks                    : NULL\n $ legend.ticks.length             : 'rel' num 0.2\n $ legend.axis.line                : NULL\n $ legend.text                     :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : 'rel' num 0.8\n  ..$ hjust        : NULL\n  ..$ vjust        : NULL\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : NULL\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ legend.text.position            : NULL\n $ legend.title                    :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : num 0\n  ..$ vjust        : NULL\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : NULL\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ legend.title.position           : NULL\n $ legend.position                 : chr \"right\"\n $ legend.position.inside          : NULL\n $ legend.direction                : NULL\n $ legend.byrow                    : NULL\n $ legend.justification            : chr \"center\"\n $ legend.justification.top        : NULL\n $ legend.justification.bottom     : NULL\n $ legend.justification.left       : NULL\n $ legend.justification.right      : NULL\n $ legend.justification.inside     : NULL\n $ legend.location                 : NULL\n $ legend.box                      : NULL\n $ legend.box.just                 : NULL\n $ legend.box.margin               : 'margin' num [1:4] 0cm 0cm 0cm 0cm\n  ..- attr(*, \"unit\")= int 1\n $ legend.box.background           : list()\n  ..- attr(*, \"class\")= chr [1:2] \"element_blank\" \"element\"\n $ legend.box.spacing              : 'simpleUnit' num 11points\n  ..- attr(*, \"unit\")= int 8\n  [list output truncated]\n - attr(*, \"class\")= chr [1:2] \"theme\" \"gg\"\n - attr(*, \"complete\")= logi TRUE\n - attr(*, \"validate\")= logi TRUE\n\nCode# Precipitation Plot\nprecip_plot &lt;- ggplot(weather) +\ngeom_area(aes(x = dateInYear, y = CulmPrec), fill = \"grey80\", color = \"blue\", alpha = 0.4) +\ngeom_vline(data = weather_month, aes(xintercept = dateInYear), linetype = 'dotted', color = 'grey70') +\ngeom_point(data = weather_record_precip, aes(x = dateInYear, y = CulmPrec), shape = 25, fill = \"black\", color = \"black\", size = 2) +\ngeom_text(data = weather_precip_summary, aes(x = Month * 30 - 15, y = total_precip + 0.75, label = paste0(total_precip)), size = 3) +\nscale_x_continuous(breaks = seq(15, 365, by = 30), labels = NULL) +\nlabs(title = \"Precipitation\", y = \"\", x = \"\") +\ncoord_cartesian(ylim = c(0, 8)) +\ntheme_classic() +\ntheme(axis.title.y = element_text(angle = 0, vjust = 0.5),\naxis.line.x = element_blank())\n\ngrid.arrange(tempplot, precip_plot, ncol = 1, heights = c(4, 1.5))\n\n\n\n\n\n\n\n\n\n\n\n\n\nFiner Control\n\n\n\nIf you‚Äôd like finer control of the width of these lines/rectangles, check out the geom_rect documentation page.",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>3 Advanced Data Viz</span>"
    ]
  },
  {
    "objectID": "src/ica/03-adv-ggplot-notes.html#exercise-4",
    "href": "src/ica/03-adv-ggplot-notes.html#exercise-4",
    "title": "3 Advanced Data Viz",
    "section": "Exercise 4",
    "text": "Exercise 4\nRecreate the visual demarcations of the months by adding vertical lines separating the months. Brainstorm how we might draw those vertical lines. What geom might we use? What subset of the data might we use in that geom layer to draw lines only at the month divisions?",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>3 Advanced Data Viz</span>"
    ]
  },
  {
    "objectID": "src/ica/03-adv-ggplot-notes.html#exercise-5",
    "href": "src/ica/03-adv-ggplot-notes.html#exercise-5",
    "title": "3 Advanced Data Viz",
    "section": "Exercise 5",
    "text": "Exercise 5\nChange the x-axis labels so that the month names display in the center of each month‚Äôs slice of the plot.\n\n\n\n\n\n\nMonth Names\n\n\n\nR has built-in variables called month.abb and month.name that contain abbreviated and full month names.\n\n\nTry to figuring out this new challenge using search engines and LLMs:\n\nSearch Engines. Use Google to search for possible solutions using the jargon that is most likely to return the most relevant results. Record search queries and your thought process in selecting which search results to look at first.\nLLMs. Use ChatGPT or Gemini with prompts that will most efficiently get you the desired results. Record the chat prompts used and output given. Evaluate the output. Do you fully understand the code generated? How can you tell that the generated code is correct?",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>3 Advanced Data Viz</span>"
    ]
  },
  {
    "objectID": "src/ica/03-adv-ggplot-notes.html#exercise-6",
    "href": "src/ica/03-adv-ggplot-notes.html#exercise-6",
    "title": "3 Advanced Data Viz",
    "section": "Exercise 6",
    "text": "Exercise 6\nCreate a precipitation plot that looks like the following. Note that\n\nThe triangles point to precipitation records‚Äìrefer to the data codebook above for the RecordP variable.\nThe numbers on the plot indicate the total precipitation for the month‚Äìsearch the hjust and vjust options to adjust the alignment of the numbers.\nThe blue and tan colors hex codes are \"#32a3d8\" and \"#ebeae2\", respectively.\n\n\n\nSFO Precipitation in 2011",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>3 Advanced Data Viz</span>"
    ]
  },
  {
    "objectID": "src/ica/03-adv-ggplot-notes.html#done",
    "href": "src/ica/03-adv-ggplot-notes.html#done",
    "title": "3 Advanced Data Viz",
    "section": "Done!",
    "text": "Done!\n\nCheck the ICA Instructions for how to (a) push your code to GitHub and (b) update your portfolio website",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>3 Advanced Data Viz</span>"
    ]
  },
  {
    "objectID": "src/ica/03-adv-ggplot-notes.html#footnotes",
    "href": "src/ica/03-adv-ggplot-notes.html#footnotes",
    "title": "3 Advanced Data Viz",
    "section": "",
    "text": "The exercise in this lesson are inspired by an assignment from the Concepts in Computing with Data course at UC Berkeley taught by Dr.¬†Deborah Nolan.‚Ü©Ô∏é",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>3 Advanced Data Viz</span>"
    ]
  },
  {
    "objectID": "src/ica/04-adv-maps-1-notes.html",
    "href": "src/ica/04-adv-maps-1-notes.html",
    "title": "4 Advanced Spatial Viz P1",
    "section": "",
    "text": "üß© Learning Goals\nBy the end of this lesson, you should be able to:",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>4 Advanced Spatial Viz P1</span>"
    ]
  },
  {
    "objectID": "src/ica/04-adv-maps-1-notes.html#learning-goals",
    "href": "src/ica/04-adv-maps-1-notes.html#learning-goals",
    "title": "4 Advanced Spatial Viz P1",
    "section": "",
    "text": "Understand the basics of a CRS (coordinate reference system)\nUnderstand and recognize different spatial file types and data types in R\nImplement some of the basic plotting with the sf package\nUnderstand foundational ideas in working with spatial data (aggregating spatial point data to a spatial region, joining spatial data sets)",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>4 Advanced Spatial Viz P1</span>"
    ]
  },
  {
    "objectID": "src/ica/04-adv-maps-1-notes.html#additional-resources",
    "href": "src/ica/04-adv-maps-1-notes.html#additional-resources",
    "title": "4 Advanced Spatial Viz P1",
    "section": "Additional Resources",
    "text": "Additional Resources\n\nSpatial Data Science with Applications in R book: web\n\nSpatial Data Science with R and terra Resources: web\n\nLeaflet in R Package: web\n\nCRAN task view on spatial analysis: web",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>4 Advanced Spatial Viz P1</span>"
    ]
  },
  {
    "objectID": "src/ica/04-adv-maps-1-notes.html#setup",
    "href": "src/ica/04-adv-maps-1-notes.html#setup",
    "title": "4 Advanced Spatial Viz P1",
    "section": "Setup",
    "text": "Setup\nFor this activity, create the following directory structure in your portfolio repository under src/ica folder:\nportfolio\n‚îî‚îÄ¬†src\n¬†¬†¬†‚îî‚îÄ¬†ica\n¬†¬†¬†¬†¬†¬†‚îî‚îÄ¬†04_adv_maps\n¬†¬†¬†¬†¬†¬†¬†¬†¬†‚îú‚îÄ¬†code\n¬†¬†¬†¬†¬†¬†¬†¬†¬†‚îÇ¬†¬†‚îî‚îÄ¬†04-adv-maps-1-notes.qmd\n¬†¬†¬†¬†¬†¬†¬†¬†¬†‚îú‚îÄ¬†data\n¬†¬†¬†¬†¬†¬†¬†¬†¬†‚îÇ¬†¬†‚îî‚îÄ¬†...  ‚Üê saving data here during this activity\n¬†¬†¬†¬†¬†¬†¬†¬†¬†‚îî‚îÄ¬†figures\n¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†‚îî‚îÄ¬†...  ‚Üê saving created maps here during this activity\nFirst load required packages.\n\nCode#Install these packages first\n\n#install.packages(c(\"sf\",\"elevatr\",\"terra\",\"stars\",\"tidycensus\"))\n#install.packages('devtools')\n#devtools::install_github(\"ropensci/USAboundaries\")\n#install.packages(\"USAboundariesData\", repos = \"https://ropensci.r-universe.dev\", type = \"source\")\n\n\nlibrary(tidyverse)\nlibrary(sf) # tools for working with spatial vector data (GIS functionality, mapping)\nlibrary(elevatr) # access to raster elevation maps\nlibrary(terra)\nlibrary(stars)\nlibrary(tidycensus) # spatial data for the US with census information\nlibrary(USAboundaries) # access to boundaries for US states, counties, zip codes, and congressional districts",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>4 Advanced Spatial Viz P1</span>"
    ]
  },
  {
    "objectID": "src/ica/04-adv-maps-1-notes.html#spatial-data-in-r",
    "href": "src/ica/04-adv-maps-1-notes.html#spatial-data-in-r",
    "title": "4 Advanced Spatial Viz P1",
    "section": "Spatial Data in R",
    "text": "Spatial Data in R\nSee Spatial Data Appendix for basics of CRS and spatial data types.\nDownload Shapefiles\n\nNavigate to the following URLs to download the spatial data files we‚Äôll be using in this activity. Put these files in the data folder of your 04_adv_maps folder.\n\n\nMN cities: https://gisdata.mn.gov/dataset/loc-pop-centers\n\nFile type: shapefile (.shp)\nFile name: shp_loc_pop_centers.zip (Unzip this after downloading.)\n\n\nMN water: https://gisdata.mn.gov/dataset/us-mn-state-metc-water-lakes-rivers\n\nFile type: shapefile (.shp)\nFile name: shp_water_lakes_rivers.zip (Unzip this after downloading.)\n\n\nRead in Files\n\nRead in the MN cities and MN water shapefiles by entering the correct relative paths in st_read(). Tab completion will be very helpful here: type part of a directory or file name and hit tab to autocomplete or bring up a dropdown of options.\n\n\n\nCode# The sf package comes with a North Carolina shapefile:\nnc &lt;- st_read(system.file(\"shape/nc.shp\", package = \"sf\"))\n\nReading layer `nc' from data source \n  `/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/sf/shape/nc.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 100 features and 14 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: -84.32385 ymin: 33.88199 xmax: -75.45698 ymax: 36.58965\nGeodetic CRS:  NAD27\n\nCode# Read in shapefiles just downloaded\nmn_cities &lt;- st_read(\"../../data/shp_loc_pop_centers/city_and_township_population_centers.shp\")\n\nReading layer `city_and_township_population_centers' from data source \n  `/Users/munyaradzi/Desktop/STAT212/portfolio_mmunyaradzi/data/shp_loc_pop_centers/city_and_township_population_centers.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 1081 features and 8 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 190832.6 ymin: 4816672 xmax: 747463.4 ymax: 5468045\nProjected CRS: NAD83 / UTM zone 15N\n\nCodemn_water  &lt;- st_read(\"../../data/shp_water_lakes_rivers/LakesAndRivers.shp\")\n\nReading layer `LakesAndRivers' from data source \n  `/Users/munyaradzi/Desktop/STAT212/portfolio_mmunyaradzi/data/shp_water_lakes_rivers/LakesAndRivers.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 2313 features and 8 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 419538.6 ymin: 4922700 xmax: 522665 ymax: 5029945\nProjected CRS: NAD83 / UTM zone 15N\n\nCodeview(mn_cities)\n\n\nThe sf package reads in spatial data in data.frame-like format. Using the class() function we can check the class (type) of object that we just read in. Note the presence of the ‚Äúsf‚Äù and ‚Äúdata.frame‚Äù classes:\n\nCodeclass(nc)\n\n[1] \"sf\"         \"data.frame\"\n\nCodeclass(mn_cities)\n\n[1] \"sf\"         \"data.frame\"\n\nCodeclass(mn_water)\n\n[1] \"sf\"         \"data.frame\"\n\n\nWhen we read in spatial objects, it is useful to check what CRS underlies the data. We can do that with st_crs() from the sf package:\n\nCodest_crs(nc)\n\nCoordinate Reference System:\n  User input: NAD27 \n  wkt:\nGEOGCRS[\"NAD27\",\n    DATUM[\"North American Datum 1927\",\n        ELLIPSOID[\"Clarke 1866\",6378206.4,294.978698213898,\n            LENGTHUNIT[\"metre\",1]]],\n    PRIMEM[\"Greenwich\",0,\n        ANGLEUNIT[\"degree\",0.0174532925199433]],\n    CS[ellipsoidal,2],\n        AXIS[\"latitude\",north,\n            ORDER[1],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        AXIS[\"longitude\",east,\n            ORDER[2],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n    ID[\"EPSG\",4267]]\n\n\nWe can treat sf objects similarly to ordinary datasets when using ggplot2 to make spatial visualizations:\n\nCodeggplot(nc) +\n    geom_sf() +\n    theme_classic() +\n    labs(title = \"NAD27\")\n\n\n\n\n\n\n\nChange CRS\n\nLet‚Äôs explore how changing the CRS changes the map. The st_transform() function in sf re-expresses a spatial object using a user-supplied CRS. The crs argument takes a string descriptor of the CRS. We can find these descriptors via https://epsg.io. In the example below, I searched for ‚ÄúSouth Carolina‚Äù.\n\n\nCodenc_transformed &lt;- nc |&gt; st_transform(crs = \"EPSG:32133\")\nst_crs(nc_transformed)\n\nCoordinate Reference System:\n  User input: EPSG:32133 \n  wkt:\nPROJCRS[\"NAD83 / South Carolina\",\n    BASEGEOGCRS[\"NAD83\",\n        DATUM[\"North American Datum 1983\",\n            ELLIPSOID[\"GRS 1980\",6378137,298.257222101,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4269]],\n    CONVERSION[\"SPCS83 South Carolina zone (meter)\",\n        METHOD[\"Lambert Conic Conformal (2SP)\",\n            ID[\"EPSG\",9802]],\n        PARAMETER[\"Latitude of false origin\",31.8333333333333,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8821]],\n        PARAMETER[\"Longitude of false origin\",-81,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8822]],\n        PARAMETER[\"Latitude of 1st standard parallel\",34.8333333333333,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8823]],\n        PARAMETER[\"Latitude of 2nd standard parallel\",32.5,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8824]],\n        PARAMETER[\"Easting at false origin\",609600,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8826]],\n        PARAMETER[\"Northing at false origin\",0,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8827]]],\n    CS[Cartesian,2],\n        AXIS[\"easting (X)\",east,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"northing (Y)\",north,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Engineering survey, topographic mapping.\"],\n        AREA[\"United States (USA) - South Carolina - counties of Abbeville; Aiken; Allendale; Anderson; Bamberg; Barnwell; Beaufort; Berkeley; Calhoun; Charleston; Cherokee; Chester; Chesterfield; Clarendon; Colleton; Darlington; Dillon; Dorchester; Edgefield; Fairfield; Florence; Georgetown; Greenville; Greenwood; Hampton; Horry; Jasper; Kershaw; Lancaster; Laurens; Lee; Lexington; Marion; Marlboro; McCormick; Newberry; Oconee; Orangeburg; Pickens; Richland; Saluda; Spartanburg; Sumter; Union; Williamsburg; York.\"],\n        BBOX[32.05,-83.36,35.21,-78.52]],\n    ID[\"EPSG\",32133]]\n\nCodeggplot(nc_transformed) +\n    geom_sf() +\n    theme_classic()\n\n\n\n\n\n\n\nThe goal is to use https://epsg.io to find two CRSs that result in a North Carolina map that is noticeably different from the original in the NAD27 CRS.\nTake a look at the function below that re-maps a spatial object using a new CRS.\n\nRead through the function to get a sense for how this code works.\n\nspatial_obj and new_crs are called arguments (function inputs).\n\nAdd one more argument called title to this function. Use this input to set the plot title.\n\n\nUse your function to make two new maps using your chosen CRSs.\n\n\nCodetransform_and_plot &lt;- function(spatial_obj, new_crs) {\n    spatial_obj |&gt; \n        st_transform(crs = new_crs) |&gt; \n        ggplot() +\n            geom_sf() +\n            theme_classic()\n}\n\n# Example usage of this function (using a South Carolina CRS)\ntransform_and_plot(nc, new_crs = \"EPSG:32133\")\n\n\n\n\n\n\n\nVerify your understanding: If you had point location data that was not in the NAD27 CRS, what would you expect about the accuracy of how they would be overlaid on the original North Carolina map?",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>4 Advanced Spatial Viz P1</span>"
    ]
  },
  {
    "objectID": "src/ica/04-adv-maps-1-notes.html#mn-map-with-multiple-layers",
    "href": "src/ica/04-adv-maps-1-notes.html#mn-map-with-multiple-layers",
    "title": "4 Advanced Spatial Viz P1",
    "section": "MN Map with Multiple Layers",
    "text": "MN Map with Multiple Layers\nGoal: create a map of MN with different layers of information (city point locations, county polygon boundaries, rivers as lines and polygons, and a raster elevation map).\nGet County Boundaries\n\nWe‚Äôve already read in city location and water information from external shapefiles. We can access county boundaries with the us_counties() function in the USAboundaries package.\n\n\nCode# Load country boundaries data as sf object\nmn_counties &lt;- USAboundaries::us_counties(resolution = \"high\", states = \"Minnesota\")\n\n# Take care of duplicate column names (there are two identical \"state_name\" columns)\nnames_counties &lt;- names(mn_counties)\nnames(mn_counties)[names_counties == \"state_name\"] &lt;- c(\"state_name1\", \"state_name2\")\n\n\nUnifying CRSs Across Different Spatial Datasets\n\nWe first need to ensure that the CRS is the same for all spatial datasets.\n\n\nCheck the CRS for the mn_cities, mn_water, and mn_counties datasets.\nIf the datasets don‚Äôt all have the same CRS, use st_transform() to update the datasets to have the same CRS as mn_cities. You can use crs = st_crs(mn_cities) within st_transform().\n\n\nCode# Check CRSs\nst_crs(mn_cities)\n\nCoordinate Reference System:\n  User input: NAD83 / UTM zone 15N \n  wkt:\nPROJCRS[\"NAD83 / UTM zone 15N\",\n    BASEGEOGCRS[\"NAD83\",\n        DATUM[\"North American Datum 1983\",\n            ELLIPSOID[\"GRS 1980\",6378137,298.257222101,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4269]],\n    CONVERSION[\"UTM zone 15N\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",0,\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",-93,\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",0.9996,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",500000,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",0,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"(E)\",east,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"(N)\",north,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    ID[\"EPSG\",26915]]\n\n\n\nCode# Check CRSs\nst_crs(mn_water)\n\nCoordinate Reference System:\n  User input: NAD83 / UTM zone 15N \n  wkt:\nPROJCRS[\"NAD83 / UTM zone 15N\",\n    BASEGEOGCRS[\"NAD83\",\n        DATUM[\"North American Datum 1983\",\n            ELLIPSOID[\"GRS 1980\",6378137,298.257222101,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4269]],\n    CONVERSION[\"UTM zone 15N\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",0,\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",-93,\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",0.9996,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",500000,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",0,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"(E)\",east,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"(N)\",north,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    ID[\"EPSG\",26915]]\n\n\n\nCode# Check CRSs for counties\nst_crs(mn_counties) # mn_counties is different \n\nCoordinate Reference System:\n  User input: EPSG:4326 \n  wkt:\nGEOGCRS[\"WGS 84\",\n    DATUM[\"World Geodetic System 1984\",\n        ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n            LENGTHUNIT[\"metre\",1]]],\n    PRIMEM[\"Greenwich\",0,\n        ANGLEUNIT[\"degree\",0.0174532925199433]],\n    CS[ellipsoidal,2],\n        AXIS[\"geodetic latitude (Lat)\",north,\n            ORDER[1],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        AXIS[\"geodetic longitude (Lon)\",east,\n            ORDER[2],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n    USAGE[\n        SCOPE[\"Horizontal component of 3D system.\"],\n        AREA[\"World.\"],\n        BBOX[-90,-180,90,180]],\n    ID[\"EPSG\",4326]]\n\n\nCounties + Cities\n\nCreate a map where city locations are overlaid on a map of county boundaries.\n\n\nYou will need to call geom_sf() twice.\nMake the map background white.\nInstall the ggthemes package, and add the following layer to use a clean map theme: + ggthemes::theme_map()\n\n\n\nCode# install ggthemes\n# install.packages(\"ggthemes\")\n\n# Transform the CRS of county data to the more local CRS of the cities\nmn_counties &lt;- mn_counties %&gt;%\n    st_transform(crs = st_crs(mn_cities))\n\n# Check the new CRS for mn_counties\nst_crs(mn_counties)\n\nCoordinate Reference System:\n  User input: NAD83 / UTM zone 15N \n  wkt:\nPROJCRS[\"NAD83 / UTM zone 15N\",\n    BASEGEOGCRS[\"NAD83\",\n        DATUM[\"North American Datum 1983\",\n            ELLIPSOID[\"GRS 1980\",6378137,298.257222101,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4269]],\n    CONVERSION[\"UTM zone 15N\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",0,\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",-93,\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",0.9996,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",500000,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",0,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"(E)\",east,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"(N)\",north,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    ID[\"EPSG\",26915]]\n\nCode# create map\n\nggplot() + # plots frame\n    geom_sf(data = mn_counties, fill = \"white\") + # county boundary layer in color white\n    geom_sf(data = mn_cities, size = 0.5) + # city point layer\n    ggthemes::theme_map()\n\n\n\n\n\n\n\nCustomize Colors\n\nWe can use traditional ggplot2 aesthetics (e.g., fill, color) to display location specific attributes. Below we only plot large cities, and we color and size cities according to their population.\n\n\nCodeggplot() +\n    geom_sf(data = mn_counties, fill = \"white\") + \n    geom_sf(data = mn_cities |&gt; filter(Population &gt;= 10000), mapping = aes(color = Population, size = Population)) + # cities layer\n    scale_color_viridis_c() + # continuous (gradient) color scale\n    labs(title = \"Minnesota Cities with Population &gt;= 10,000\") + \n    ggthemes::theme_map() +\n    theme(legend.position = \"bottom\") # move legend\n\n\n\n\n\n\n\nLook up the scale_color_viridis_c() documentation via the ggplot2 reference.\n\nRead the function description at the top. What is the advantage of using this function for making color palettes?\nLook through the examples section. What is the difference between the _d(), _c(), and _b() variants of this function?\n\n\nThe _d() variant is used when color is mapped to a discrete (categorical) variable e.g gender, haorcolor.\n\n\nThe _c() variant is used when color is mapped to a continuous variable e.g temperature\n\n\nThe _b() variant is used when color is mapped to a continuous variable but when we want that continuous variable to be binned so that there is a small set of colors.\n\nAdding Elevation Raster Data\nWhere are large cities located? Is there some relationship to local geography/terrain?\n\nTo investigate these questions, we can obtain elevation data to include on the map using the elevatr package. We encounter two new functions here‚Äîwe can look up their documentation to make sense of the code by entering the following in the Console:\n\n\n?elevatr::get_elev_raster\n?terra::as.data.frame\n\n\nCodeelevation &lt;- elevatr::get_elev_raster(mn_counties, z = 5, clip = \"bbox\")\nraster::crs(elevation) &lt;- sf::st_crs(mn_counties)\n\n# Convert to data frame for plotting\nelev_df &lt;- elevation |&gt; terra::as.data.frame(xy = TRUE)\ncolnames(elev_df) &lt;- c(\"x\", \"y\", \"elevation\")\n\n\nBuild on our existing map by adding a raster layer for elevation as the background.\n\nLook up the documentation for geom_raster() to plot the elevation data from elev_df. This will be the first layer of the plot.\nLook at the documentation for scale_fill_gradient() to add the following elevation color scale: \"darkgreen\" represents the lowest elevations, and \"white\" represents the highest elevations.\nAdd in the layers from the map above to show the largest cities and the county outlines. To remove a background color, use fill = NA.\n\n\nCodeggplot() +\n    geom_raster(data = elev_df, aes(x = x, y = y, fill = elevation)) + # adding the elevation as first (bottom) layer\n    scale_fill_gradient(low = \"darkgreen\", high = \"white\", guide = FALSE) +\n    geom_sf(data = mn_counties, fill = NA, color = \"black\") + \n    geom_sf(data = mn_cities |&gt; filter(Population &gt;= 10000), mapping = aes(color = Population, size = Population))+ # cities layer\n    scale_color_viridis_c() + # continuous (gradient) color scale\n    labs(title = \"Minnesota Cities with Population &gt;= 10,000\") + \n    ggthemes::theme_map() +\n    theme(legend.position = \"bottom\") # move legend\n\n\n\n\n\n\n\nZoom in to Twin Cities and Add Water\n\nThe bulk of the interesting information in this map is in the Twin Cities area. Let‚Äôs zoom in to this area.\n\n\nWe can use the st_bbox() function to get the bounding box for a spatial object‚Äîwe do this after filtering to the 7 counties in the Twin Cities.\nWe then use st_crop() to trim a spatial object to a given bounding box.\n\n\nCodeseven_countyarea &lt;- mn_counties |&gt;\n    filter(name %in% c(\"Anoka\", \"Hennepin\", \"Ramsey\", \"Dakota\", \"Carver\", \"Washington\", \"Scott\")) |&gt; \n    st_bbox()\nseven_countyarea\n\n     xmin      ymin      xmax      ymax \n 419967.1 4924212.8  521254.8 5029157.4 \n\nCodeelevation &lt;- elevatr::get_elev_raster(mn_counties |&gt; st_crop(seven_countyarea), z = 9, clip = \"bbox\")\nraster::crs(elevation) &lt;- sf::st_crs(mn_counties)\n\n# Convert to data frame for plotting\nelev_df &lt;- elevation |&gt; terra::as.data.frame(xy = TRUE)\ncolnames(elev_df) &lt;- c(\"x\", \"y\", \"elevation\")\n\n\nIn the plot below, we add a layer for water information and a coord_sf() layer to restrict the x and y-axis limits to the Twin Cities bounding box. (Without this layer, the map would zoom back out to show all counties and bodies of water).\n\nCodeggplot() +\n    geom_raster(data = elev_df, aes(x = x, y = y, fill = elevation)) + \n    geom_sf(data = mn_counties, fill = NA, color = \"black\") + # county boundary layer\n    geom_sf(data = mn_water, fill = \"lightsteelblue1\", color = \"lightsteelblue1\") + # NEW: river/lake layer\n    geom_sf(data = mn_cities |&gt; filter(Population &gt;= 10000), mapping = aes(color = Population, size = Population)) + # cities layer\n    scale_color_viridis_c(option = \"magma\") + # continuous (gradient) color scale\n    scale_fill_gradient(low = \"darkgreen\", high = \"white\") + # continuous (gradient) fill scale\n    coord_sf(xlim = seven_countyarea[c(\"xmin\", \"xmax\")], ylim = seven_countyarea[c(\"ymin\", \"ymax\")]) + # NEW: crop map to Twin Cities bounding box\n    labs(title = \"Twin Cities with Population &gt;= 10,000\") + \n    ggthemes::theme_map() +\n    theme(legend.position = \"none\") # remove legend\n\n\n\n\n\n\n\nLet‚Äôs add to the above code chunk to save the map above to an image file called tc_map_zoom.png in the figures folder. The code example below shows a general template for saving a plot to file. Choose a reasonable width and height. (There are also jpeg() and pdf() functions for writing images.)\n\nCodepng(\"relative path to image\", width = width_in_pixels, height = height_in_pixels)\n# Code for creating plot\ndev.off()",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>4 Advanced Spatial Viz P1</span>"
    ]
  },
  {
    "objectID": "src/ica/04-adv-maps-1-notes.html#going-beyond---twin-cities-map-with-leaflet",
    "href": "src/ica/04-adv-maps-1-notes.html#going-beyond---twin-cities-map-with-leaflet",
    "title": "4 Advanced Spatial Viz P1",
    "section": "Going Beyond - Twin Cities Map with leaflet\n",
    "text": "Going Beyond - Twin Cities Map with leaflet\n\nBelow we show how to make the MN counties map in the leaflet package.\n\nCodelibrary(leaflet)\n\nmn_counties_leaf &lt;- mn_counties |&gt; st_transform(4326) # Leaflet expects this CRS for vectors\nmn_cities_leaf &lt;- mn_cities |&gt; st_transform(4326)\n\ncities_per_county &lt;- st_join(mn_cities_leaf, mn_counties_leaf) |&gt;\n    st_drop_geometry() |&gt; # removes geometry - makes the following calculation more efficient\n    count(name) \n\nmn_counties_leaf |&gt; \n    filter(name %in% c(\"Anoka\", \"Hennepin\", \"Ramsey\", \"Dakota\", \"Carver\", \"Washington\", \"Scott\")) |&gt;\n    left_join(cities_per_county) |&gt;\n    leaflet() |&gt; \n    addProviderTiles(\"CartoDB.Positron\") |&gt; \n    addPolygons(\n        color = \"#444444\", weight = 1, smoothFactor = 0.5, opacity = 1.0,\n        fillOpacity = 0.5, fillColor = ~colorQuantile(\"YlOrRd\", n)(n),\n        highlightOptions = highlightOptions(color = \"white\", weight = 2, bringToFront = TRUE)) |&gt;\n    addCircles(data = mn_cities_leaf |&gt; filter(County %in% paste(c(\"Anoka\", \"Hennepin\", \"Ramsey\", \"Dakota\", \"Carver\", \"Washington\", \"Scott\"), \"County\")), color = \"#444444\")",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>4 Advanced Spatial Viz P1</span>"
    ]
  },
  {
    "objectID": "src/ica/04-adv-maps-1-notes.html#done",
    "href": "src/ica/04-adv-maps-1-notes.html#done",
    "title": "4 Advanced Spatial Viz P1",
    "section": "Done!",
    "text": "Done!\n\nCheck the ICA Instructions for how to (a) push your code to GitHub and (b) update your portfolio website",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>4 Advanced Spatial Viz P1</span>"
    ]
  },
  {
    "objectID": "src/ica/07-wrangling-2-notes.html",
    "href": "src/ica/07-wrangling-2-notes.html",
    "title": "7 Adv Data wrangling P2",
    "section": "",
    "text": "üß© Learning Goals\nBy the end of this lesson, you should be able to:",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>7 Adv Data wrangling P2</span>"
    ]
  },
  {
    "objectID": "src/ica/07-wrangling-2-notes.html#learning-goals",
    "href": "src/ica/07-wrangling-2-notes.html#learning-goals",
    "title": "7 Adv Data wrangling P2",
    "section": "",
    "text": "Manipulate and explore strings using the stringr package\nConstruct regular expressions to find patterns in strings",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>7 Adv Data wrangling P2</span>"
    ]
  },
  {
    "objectID": "src/ica/07-wrangling-2-notes.html#helpful-cheatsheets",
    "href": "src/ica/07-wrangling-2-notes.html#helpful-cheatsheets",
    "title": "7 Adv Data wrangling P2",
    "section": "Helpful Cheatsheets",
    "text": "Helpful Cheatsheets\nThe stringr cheatsheet (HTML, PDF) will be useful to have open and reference.",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>7 Adv Data wrangling P2</span>"
    ]
  },
  {
    "objectID": "src/ica/07-wrangling-2-notes.html#motivation-30-years-of-american-anxieties",
    "href": "src/ica/07-wrangling-2-notes.html#motivation-30-years-of-american-anxieties",
    "title": "7 Adv Data wrangling P2",
    "section": "Motivation: 30 Years of American Anxieties",
    "text": "Motivation: 30 Years of American Anxieties\nIn 2018 the data journalism organization The Pudding featured a story called 30 Years of American Anxieties about themes in 30 years of posts to the Dear Abby column (an American advice column).\nOne way to understand themes in text data is to conduct a qualitative analysis, a methodology in which multiple readers read through instances of text several times to reach a consensus about themes.\nAnother way to understand themes in text data is computational text analysis.\n\nThis is what we will explore today.\n\nBoth qualitative analysis and computational tools can be used in tandem. Often, using computational tools can help focus a close reading of select texts, which parallels the spirit of a qualitative analysis.\nTo prepare ourselves for a computational analysis, let‚Äôs learn about strings.",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>7 Adv Data wrangling P2</span>"
    ]
  },
  {
    "objectID": "src/ica/07-wrangling-2-notes.html#strings",
    "href": "src/ica/07-wrangling-2-notes.html#strings",
    "title": "7 Adv Data wrangling P2",
    "section": "Strings",
    "text": "Strings\nStrings are objects of the character class (abbreviated as &lt;chr&gt; in tibbles).\nWhen you print out strings, they display with double quotes:\n\nCodesome_string &lt;- \"banana\"\nsome_string\n\n[1] \"banana\"\n\n\nWorking with strings generally will involve the use of regular expressions, a tool for finding patterns in strings.\nRegular expressions (regex, for short) look like the following:\n\"^the\" (Strings that start with \"the\")\n\"end$\" (Strings that end with \"end\")\nBefore getting to regular expressions, let‚Äôs go over some fundamentals about working with strings. The stringr package (available within tidyverse) is great for working with strings.",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>7 Adv Data wrangling P2</span>"
    ]
  },
  {
    "objectID": "src/ica/07-wrangling-2-notes.html#creating-strings",
    "href": "src/ica/07-wrangling-2-notes.html#creating-strings",
    "title": "7 Adv Data wrangling P2",
    "section": "Creating strings",
    "text": "Creating strings\nCreating strings by hand is useful for testing out regular expressions.\nTo create a string, type any text in either double quotes (\") or single quotes '. Using double or single quotes doesn‚Äôt matter unless your string itself has single or double quotes.\n\nCodestring1 &lt;- \"This is a string\"\nstring2 &lt;- 'If I want to include a \"quote\" inside a string, I use single quotes'\nstring3 &lt;- c(string1, string2) # string / character vector (of greater than length 1)\n\n\nclass(string1)\n\n[1] \"character\"\n\nCodeclass(string2)\n\n[1] \"character\"\n\nCodeclass(string3)\n\n[1] \"character\"\n\nCodelength(string1)\n\n[1] 1\n\nCodelength(string2)\n\n[1] 1\n\nCodelength(string3)\n\n[1] 2\n\n\nWe can view these strings ‚Äúnaturally‚Äù (without the opening and closing quotes) with str_view():\n\nCodestr_view(string1)\n\n[1] ‚îÇ This is a string\n\nCodestr_view(string2)\n\n[1] ‚îÇ If I want to include a \"quote\" inside a string, I use single quotes\n\nCodestr_view(string3)\n\n[1] ‚îÇ This is a string\n[2] ‚îÇ If I want to include a \"quote\" inside a string, I use single quotes\n\n\nExercise: Create the string It's Thursday. What happens if you put the string inside single quotes? Double quotes?\n\nCode# Your code\nstring_4 &lt;- \"It's Thursday\" \nstr_view((string_4))\n\n[1] ‚îÇ It's Thursday\n\n\nBecause \" and ' are special characters in the creation of strings, R offers another way to put them inside a string. We can escape these special characters by putting a \\ in front of them:\n\nCodestring1 &lt;- \"This is a string with \\\"double quotes\\\"\"\nstring2 &lt;- \"This is a string with \\'single quotes\\'\"\nstr_view(string1)\n\n[1] ‚îÇ This is a string with \"double quotes\"\n\nCodestr_view(string2)\n\n[1] ‚îÇ This is a string with 'single quotes'\n\n\nGiven that \\ is a special character, how can we put the \\ character in strings? We have to escape it with \\\\.\nExercise: Create the string C:\\Users. What happens when you don‚Äôt escape the \\?\n\nCode# Your code\n#string_5 &lt;- \"C:\\Users\"\n#str_view(string_5).     # Error: '\\U' used without hex digits in character string (&lt;input&gt;:1:17)\n\n\nOther special characters include:\n\n\n\\t (Creates a tab)\n\n\\n (Creates a newline)\n\nBoth can be useful in plots to more neatly arrange text.\n\nCodestring1 &lt;- \"Record temp:\\t102\"\nstring2 &lt;- \"Record temp:\\n102\"\n\nstr_view(string1)\n\n[1] ‚îÇ Record temp:{\\t}102\n\nCodestr_view(string2)\n\n[1] ‚îÇ Record temp:\n    ‚îÇ 102\n\n\nCan we get str_view() to show the tab instead of {\\t}? We can use the html argument to have the string displayed as if on a webpage:\n\nCodestr_view(string1, html = TRUE)\n\n\nOften we will want to create new strings within data frames. We can use str_c() or str_glue(), both of which are vectorized functions (meaning they take vectors as inputs and provide vectors as outputs - can be used within mutate()):\n\nWith str_c() the strings to be combined are all separate arguments separated by commas.\nWith str_glue() the desired string is written as a template with variable names inside curly braces {}.\n\n\nCodedf &lt;- tibble(\n    first_name = c(\"Arya\", \"Olenna\", \"Tyrion\", \"Melisandre\"),\n    last_name = c(\"Stark\", \"Tyrell\", \"Lannister\", NA)\n)\ndf\n\n# A tibble: 4 √ó 2\n  first_name last_name\n  &lt;chr&gt;      &lt;chr&gt;    \n1 Arya       Stark    \n2 Olenna     Tyrell   \n3 Tyrion     Lannister\n4 Melisandre &lt;NA&gt;     \n\nCodedf |&gt;\n    mutate(\n        full_name1 = str_c(first_name, \" \", last_name),\n        full_name2 = str_glue(\"{first_name} {last_name}\")\n    )\n\n# A tibble: 4 √ó 4\n  first_name last_name full_name1       full_name2      \n  &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;            &lt;glue&gt;          \n1 Arya       Stark     Arya Stark       Arya Stark      \n2 Olenna     Tyrell    Olenna Tyrell    Olenna Tyrell   \n3 Tyrion     Lannister Tyrion Lannister Tyrion Lannister\n4 Melisandre &lt;NA&gt;      &lt;NA&gt;             Melisandre NA   \n\n\nExercise: In the following data frame, create a full date string in month-day-year format using both str_c() and str_glue().\n\nCodedf_dates &lt;- tibble(\n    year = c(2000, 2001, 2002),\n    month = c(\"Jan\", \"Feb\", \"Mar\"),\n    day = c(3, 4, 5)\n)\n\ndf_dates |&gt;\n    mutate(\n        full_date1 = str_c(month,\"-\", day,\"-\", year),\n        full_date2 = str_glue(\"{month}-{day}-{year}\")\n    )\n\n# A tibble: 3 √ó 5\n   year month   day full_date1 full_date2\n  &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;glue&gt;    \n1  2000 Jan       3 Jan-3-2000 Jan-3-2000\n2  2001 Feb       4 Feb-4-2001 Feb-4-2001\n3  2002 Mar       5 Mar-5-2002 Mar-5-2002",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>7 Adv Data wrangling P2</span>"
    ]
  },
  {
    "objectID": "src/ica/07-wrangling-2-notes.html#extracting-information-from-strings",
    "href": "src/ica/07-wrangling-2-notes.html#extracting-information-from-strings",
    "title": "7 Adv Data wrangling P2",
    "section": "Extracting information from strings",
    "text": "Extracting information from strings\nThe str_length() counts the number of characters in a string.\n\nCodecomments &lt;- tibble(\n    name = c(\"Alice\", \"Bob\"),\n    comment = c(\"The essay was well organized around the core message and had good transitions.\", \"Good job!\")\n)\n\ncomments |&gt;\n    mutate(\n        comment_length = str_length(comment)\n    )\n\n# A tibble: 2 √ó 3\n  name  comment                                                   comment_length\n  &lt;chr&gt; &lt;chr&gt;                                                              &lt;int&gt;\n1 Alice The essay was well organized around the core message and‚Ä¶             78\n2 Bob   Good job!                                                              9\n\n\nThe str_sub() function gets a substring of a string. The 2nd and 3rd arguments indicate the beginning and ending position to extract.\n\nNegative positions indicate the position from the end of the word. (e.g., -3 indicates ‚Äú3rd letter from the end‚Äù)\nSpecifying a position that goes beyond the word won‚Äôt result in an error. str_sub() will just go as far as possible.\n\n\nCodex &lt;- c(\"Apple\", \"Banana\", \"Pear\")\n\nstr_sub(x, start = 1, end = 3)\n\n[1] \"App\" \"Ban\" \"Pea\"\n\nCodestr_sub(x, start = -3, end = -1)\n\n[1] \"ple\" \"ana\" \"ear\"\n\nCodestr_sub(x, start = 2, end = -1)\n\n[1] \"pple\"  \"anana\" \"ear\"  \n\nCodestr_sub(\"a\", start = 1, end = 15)\n\n[1] \"a\"\n\n\nExercise: Using str_sub(), create a new variable with only the middle letter of each word in the data frame below. (Challenge: How would you handle words with an even number of letters?)\n\nCodedf &lt;- tibble(\n    word_id = 1:3,\n    word = c(\"replace\", \"match\", \"pattern\")\n)\n\ndf |&gt; \n  mutate(\n    word_length =str_length(word),\n    mid_pt = ceiling(word_length/2),\n    middle_letter = str_sub(word, mid_pt, mid_pt)\n  )\n\n# A tibble: 3 √ó 5\n  word_id word    word_length mid_pt middle_letter\n    &lt;int&gt; &lt;chr&gt;         &lt;int&gt;  &lt;dbl&gt; &lt;chr&gt;        \n1       1 replace           7      4 l            \n2       2 match             5      3 t            \n3       3 pattern           7      4 t",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>7 Adv Data wrangling P2</span>"
    ]
  },
  {
    "objectID": "src/ica/07-wrangling-2-notes.html#finding-patterns-in-strings-with-regular-expressions",
    "href": "src/ica/07-wrangling-2-notes.html#finding-patterns-in-strings-with-regular-expressions",
    "title": "7 Adv Data wrangling P2",
    "section": "Finding patterns in strings with regular expressions",
    "text": "Finding patterns in strings with regular expressions\nSuppose that you‚Äôre exploring text data looking for places where people describe happiness. There are many ways to search. We could search for the word ‚Äúhappy‚Äù but that excludes ‚Äúhappiness‚Äù so we might search for ‚Äúhappi‚Äù.\nRegular expressions (regex) are a powerful language for describing patterns within strings.\n. . .\n\nCodedata(fruit)\ndata(words)\ndata(sentences)\n\n\nWe can use str_view() with the pattern argument to see what parts of a string match the regex supplied in the pattern argument. (Matches are enclosed in &lt;&gt;.)\n\nCodestr_view(fruit, \"berry\")\n\n [6] ‚îÇ bil&lt;berry&gt;\n [7] ‚îÇ black&lt;berry&gt;\n[10] ‚îÇ blue&lt;berry&gt;\n[11] ‚îÇ boysen&lt;berry&gt;\n[19] ‚îÇ cloud&lt;berry&gt;\n[21] ‚îÇ cran&lt;berry&gt;\n[29] ‚îÇ elder&lt;berry&gt;\n[32] ‚îÇ goji &lt;berry&gt;\n[33] ‚îÇ goose&lt;berry&gt;\n[38] ‚îÇ huckle&lt;berry&gt;\n[50] ‚îÇ mul&lt;berry&gt;\n[70] ‚îÇ rasp&lt;berry&gt;\n[73] ‚îÇ salal &lt;berry&gt;\n[76] ‚îÇ straw&lt;berry&gt;\n\n\nEssentials of forming a regex\n\nLetters and numbers in a regex are matched exactly and are called literal characters.\nMost punctuation characters, like ., +, *, [, ], and ?, have special meanings and are called metacharacters.\n\nQuantifiers come after a regex and control how many times a pattern can match:\n\n\n?: match the preceding pattern 0 or 1 times\n\n+: match the preceding pattern at least once\n\n*: match the preceding pattern at least 0 times (any number of times)\n\n\n\n. . .\nExercise: Before running the code below, predict what matches will be made. Run the code to check your guesses. Note that in all regex‚Äôs below the ?, +, * applies to the b only (not the a).\n\nCodestr_view(c(\"a\", \"ab\", \"abb\"), \"ab?\")\nstr_view(c(\"a\", \"ab\", \"abb\"), \"ab+\")\nstr_view(c(\"a\", \"ab\", \"abb\"), \"ab*\")\n\n\n\nWe can match any of a set of characters with [] (called a character class), e.g., [abcd] matches ‚Äúa‚Äù, ‚Äúb‚Äù, ‚Äúc‚Äù, or ‚Äúd‚Äù.\n\nWe can invert the match by starting with ^: [^abcd] matches anything except ‚Äúa‚Äù, ‚Äúb‚Äù, ‚Äúc‚Äù, or ‚Äúd‚Äù.\n\n\n\n\nCode# Match words that have vowel-x-vowel\nstr_view(words, \"[aeiou]x[aeiou]\")\n\n[284] ‚îÇ &lt;exa&gt;ct\n[285] ‚îÇ &lt;exa&gt;mple\n[288] ‚îÇ &lt;exe&gt;rcise\n[289] ‚îÇ &lt;exi&gt;st\n\nCode# Match words that have not_vowel-y-not_vowel\nstr_view(words, \"[^aeiou]y[^aeiou]\")\n\n[836] ‚îÇ &lt;sys&gt;tem\n[901] ‚îÇ &lt;typ&gt;e\n\n\nExercise Using the words data, find words that have two vowels in a row followed by an ‚Äúm‚Äù.\n\nCode# Your code\n\n\n\nThe alternation operator | can be read just like the logical operator | (‚ÄúOR‚Äù) to pick between one or more alternative patterns. e.g., apple|banana searches for ‚Äúapple‚Äù or ‚Äúbanana‚Äù.\n\n\nCodestr_view(fruit, \"apple|melon|nut\")\n\n [1] ‚îÇ &lt;apple&gt;\n[13] ‚îÇ canary &lt;melon&gt;\n[20] ‚îÇ coco&lt;nut&gt;\n[52] ‚îÇ &lt;nut&gt;\n[62] ‚îÇ pine&lt;apple&gt;\n[72] ‚îÇ rock &lt;melon&gt;\n[80] ‚îÇ water&lt;melon&gt;\n\n\nExercise: Using the fruit data, find fruits that have a repeated vowel (‚Äúaa‚Äù, ‚Äúee‚Äù, ‚Äúii‚Äù, ‚Äúoo‚Äù, or ‚Äúuu‚Äù.)\n\nCode# Your code\n\n\n\nThe ^ operator indicates the beginning of a string, and the $ operator indicates the end of a string. e.g., ^a matches strings that start with ‚Äúa‚Äù, and a$ matches words that end with ‚Äúa‚Äù.\nParentheses group together parts of a regular expression that should be taken as a bundle. (Much like parentheses in arithmetic statements.)\n\ne.g., ab+ is a little confusing. Does it match ‚Äúab‚Äù one or more times? Or does it match ‚Äúa‚Äù first, then just ‚Äúb‚Äù one or more times? (The latter, as we saw in an earlier example.) We can be very explicit and use a(b)+.\n\n\n\nExercise: Using the words data, find (1) words that start with ‚Äúy‚Äù and (2) words that don‚Äôt start with ‚Äúy‚Äù.\n\nCode# Your code",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>7 Adv Data wrangling P2</span>"
    ]
  },
  {
    "objectID": "src/ica/07-wrangling-2-notes.html#exploring-stringr-functions",
    "href": "src/ica/07-wrangling-2-notes.html#exploring-stringr-functions",
    "title": "7 Adv Data wrangling P2",
    "section": "Exploring stringr functions",
    "text": "Exploring stringr functions\nRead in the ‚ÄúDear Abby‚Äù data underlying The Pudding‚Äôs 30 Years of American Anxieties article.\n\nCodeposts &lt;- read_csv(\"https://raw.githubusercontent.com/the-pudding/data/master/dearabby/raw_da_qs.csv\")\n\n\nTake a couple minutes to scroll through the 30 Years of American Anxieties article to get ideas for themes that you might want to search for using regular expressions.\n\nThe following are core stringr functions that use regular expressions:\n\n\nstr_view() - View the first occurrence in a string that matches the regex\n\nstr_count() - Count the number of times a regex matches within a string\n\nstr_detect() - Determine if (TRUE/FALSE) the regex is found within string\n\nstr_subset() - Return subset of strings that match the regex\n\nstr_extract(), str_extract_all() - Return portion of each string that matches the regex. str_extract() extracts the first instance of the match. str_extract_all() extracts all matches.\n\nstr_replace(), str_replace_all() - Replace portion of string that matches the regex with something else. str_replace() replaces the first instance of the match. str_replace_all() replaces all instances of the match.\n\nstr_remove(), str_remove_all() - Removes the portion of the string that matches the pattern. Equivalent to str_replace(x, \"THE REGEX PATTERN\", \"\")\n\n\nExercise: Starting from str_count(), explore each of these functions by pulling up the function documentation page and reading through the arguments. Try out each function using the posts data.",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>7 Adv Data wrangling P2</span>"
    ]
  },
  {
    "objectID": "src/ica/07-wrangling-2-notes.html#done",
    "href": "src/ica/07-wrangling-2-notes.html#done",
    "title": "7 Adv Data wrangling P2",
    "section": "Done!",
    "text": "Done!\n\nCheck the ICA Instructions for how to (a) push your code to GitHub and (b) update your portfolio website",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>7 Adv Data wrangling P2</span>"
    ]
  },
  {
    "objectID": "src/ica/08-missing-data-notes.html",
    "href": "src/ica/08-missing-data-notes.html",
    "title": "8 Missing Data",
    "section": "",
    "text": "üß© Learning Goals\nBy the end of this lesson, you should be able to:",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>8 Missing Data</span>"
    ]
  },
  {
    "objectID": "src/ica/08-missing-data-notes.html#learning-goals",
    "href": "src/ica/08-missing-data-notes.html#learning-goals",
    "title": "8 Missing Data",
    "section": "",
    "text": "Go through a data quality checklist when data wrangling\nExplain the difference between MCAR, MAR, and MNAR missing data mechanisms\nAssess what missing data mechanisms might be at play in a given dataset\nUse visualizations to explore missing data patterns\nExplain why multiple imputation is preferred to single imputation\nExplain how a simulation study can be used to investigate properties of statistical methods",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>8 Missing Data</span>"
    ]
  },
  {
    "objectID": "src/ica/08-missing-data-notes.html#data-quality-checklist",
    "href": "src/ica/08-missing-data-notes.html#data-quality-checklist",
    "title": "8 Missing Data",
    "section": "Data Quality Checklist",
    "text": "Data Quality Checklist\nWhen wrangling / cleaning data, make sure to check the assumptions you make about the data to ensure you don‚Äôt lose data quality.\n\nData Parsing (reading data into a different data format)\n\nAlways keep the original, raw data (don‚Äôt manually change it).\nUse Test Cases: Find rows or write test cases to double check the wrangling works as expected\nDATES: When using lubridate to parse dates and times, ensure the strings are consistently ordered and formatted correctly, eg, mm/dd/yy vs.¬†dd/mm/yy.\nSTRINGS: When using stringr to parse strings with regular expressions, check example rows to ensure that the pattern captured all of the examples you want and excluded the patterns you don‚Äôt want.\nAlways check for missing values to see if the missing ones are expected given the original data.\n\n\nData Joining\n\n\nIdentify missing values in the key variables and decide how to handle them before the merge process (e.g., omitting rows with missing values, imputing missing values).\nDecide on the correct join type (left, right, inner, full, etc.) OR if the data structure is the same use list_rbind() to bind rows or list_cbind() to bind columns.\nIf doing a join, make sure that the key variables (by) have the same meaning in both datasets and are represented in the same way (e.g., id = 1 to 20 in first dataset will match id = 1 - 20 in undesirable ways)\nPredict the number of rows that will result from the join and double check the anti_join() to see which rows did not find a match.\nCheck for duplicate records within each dataset and ensure they are handled appropriately before merging.\nVerify that the merged dataset maintains consistency with the original datasets in terms of data values, variable names, and variable types.\nPerform some preliminary analysis or validation checks on the merged dataset to ensure that it meets the requirements of your analysis.\n\n\nSanity Check: Visualize your data!!!\n\n\nDo the right number of points appear?\nDo the values seem reasonable?",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>8 Missing Data</span>"
    ]
  },
  {
    "objectID": "src/ica/08-missing-data-notes.html#explicit-v.-implicit-missing-data",
    "href": "src/ica/08-missing-data-notes.html#explicit-v.-implicit-missing-data",
    "title": "8 Missing Data",
    "section": "Explicit v. Implicit Missing Data",
    "text": "Explicit v. Implicit Missing Data\nExplicit missing data is data that is explicitly marked as missing. In R, this is done with NA.\nImplicit missing data is data that is missing but not explicitly marked as such.\n\nThis can happen when an entire row is missing from a dataset.\n\nFor example, if a study participant doesn‚Äôt attend a follow-up visit. It maybe not even be recorded in the data.\n\n\n\nWe need to make implicit missingness explicit before we can work with the data.\n\nConsider the combinations of variables that you‚Äôd expect to be fully present in a complete dataset.\n\nIf a combination is missing, you can create a new row with explicit missing values.\n\nFor example, if you expect every participant (each has a unique pid) to have an observation for each visit, you could use the function complete() to create that new row and plug in values of NA for the missing data.\n\n\n\n\n\nstudy_data_full &lt;- study_data |&gt; \n  complete(pid, visit)",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>8 Missing Data</span>"
    ]
  },
  {
    "objectID": "src/ica/08-missing-data-notes.html#dealing-with-missing-data",
    "href": "src/ica/08-missing-data-notes.html#dealing-with-missing-data",
    "title": "8 Missing Data",
    "section": "Dealing with missing data",
    "text": "Dealing with missing data\nIf you have explicit missing data, there are 3 main ways of proceeding:\n\n\nDrop the cases or rows with any missing data from the analysis‚Äìa complete case analysis\n\nPro: Easy to implement\nCon: reduces sample size, introduces bias if the missing data is not ‚Äúmissing completely at random‚Äù\n\n\nCreate a category for missing values.\n\nExample: The survey question ‚ÄúWhat is your gender?‚Äù might only provide two possible responses: ‚Äúmale‚Äù and ‚Äúfemale‚Äù. Missing values for this could indicate that the respondent uses a non-binary designation. Instead of dropping these cases, treating the missing data as its own category (‚ÄúDoes not wish to answer‚Äù) would be more appropriate.\nPros: Maintains sample size, may help us if data is ‚Äúmissing not at random‚Äù\nCons: Not directly applicable to continuous outcomes (could include interactions with a categorical version in models to account for it)\n\n\n\nImpute (or fill in values for) the missing data using imputation algorithms.\n\nImputation algorithms can be as simple as replacing missing values with the mean of the non-missing values (very simplistic).\nRegression imputation algorithms use models to predict missing values as a function of other variables in the data.\nPros: Maintains sample size, multiple regression imputation minimizes bias if ‚Äúmissing at random‚Äù\nCons: Computationally intensive\n\n\n\n\nDeciding between these options and proceeding with choosing finer details within an option requires an understanding of the mechanism by which data become missing.",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>8 Missing Data</span>"
    ]
  },
  {
    "objectID": "src/ica/08-missing-data-notes.html#missing-data-mechanisms",
    "href": "src/ica/08-missing-data-notes.html#missing-data-mechanisms",
    "title": "8 Missing Data",
    "section": "Missing Data Mechanisms",
    "text": "Missing Data Mechanisms\nThe reasons for which a variable might have missing data are divided into 3 mechanisms: MCAR, MAR, and MNAR.\nWithin a dataset, multiple mechanisms may be present‚Äìwe need to consider the missingness mechanism for each variable individually.\n\n\n\nMissing completely at random (MCAR):\n\nThe probability of missing data for a variable is the same for all cases. Implies that causes of the missing data are unrelated to the data. (https://stefvanbuuren.name/fimd/sec-MCAR.html)\nExamples:\n\nMeasurement device that runs out of batteries causes the remainder of observations for the day to be missing.\nData entry software requires a particular field to be typo-free, and missing values are introduced when there are typos.\n\n\nImplications for downstream work:\n\nIf a variable has MCAR missingness, a complete case analysis will be unbiased (still valid).\nHowever, with a lot of missing observations, a complete case analysis will suffer from loss of statistical power (ability to detect a real difference), and imputation will be useful to retain the original sample size.\n\n\n\n\n\nMissing at random (MAR):\n\nThe probability of missing data is related to observed variables but unrelated to unobserved information.\nExamples:\n\nBlood pressure measurements tend to be missing in patients in worse health. (Those in worse health are more likely to miss clinic visits.) Better and worse health can be measured by a variety of indicators in their health record.\nIn a survey, older people are more likely to report their income than younger people. Missingness is related to the observed age variable, but not to unobserved information.\n\n\nImplications for downstream work:\n\nTry to use imputation methods that predict the value of the missing variables from other observed variables. Assessing whether this can be done accurately takes some exploration‚Äìwe‚Äôll explore this shortly.\n\n\n\n\n\nMissing not at random (MNAR):\n\nThe probability of missing data is related to unobserved variables (and probably observed variables too).\nExamples:\n\nBlood pressure measurements are more likely to be missing for those with the highest blood pressure. This is MNAR rather than MAR because the missing data on blood pressure is related to the unobserved values themselves.\nHigh-income individuals may be less likely to report their income.\n\n\nImplications for downstream work:\n\nIdeally, we would learn more about the causes for the missingness. This could allow us to use more informed imputation models.\n\nExample: Biological measurements that tend to be missing because of concentrations that are too low (a phenomenon known as left-censoring). Imputation methods specifically suited to left-censoring are useful here.\n\n\nWe can use imputation methods with different assumptions about the missing data and try out a variety of assumptions. This lets us see how sensitive the results are under various scenarios.\n\nExample: If higher incomes are more likely to be missing, we can make different assumptions about what ‚Äúhigh‚Äù could be to fill in the missing values and see how our results change under these different assumptions.",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>8 Missing Data</span>"
    ]
  },
  {
    "objectID": "src/ica/08-missing-data-notes.html#exercise",
    "href": "src/ica/08-missing-data-notes.html#exercise",
    "title": "8 Missing Data",
    "section": "Exercise",
    "text": "Exercise\n\n\nMissing data mechanism For each of the following situations, propose what missing data mechanism you think is most likely at play.\n\n\nIn a clinical trial, some patients dropped out before the end of the study. Their reasons for dropping out were not recorded.\nA weather station records temperature, humidity, and wind speed every hour. Some of the recorded values are missing.\nA social media platform collects data on user interactions, such as likes, comments, and shares. Some interactions are not recorded due to bugs in the code.",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>8 Missing Data</span>"
    ]
  },
  {
    "objectID": "src/ica/08-missing-data-notes.html#exploring-missing-data",
    "href": "src/ica/08-missing-data-notes.html#exploring-missing-data",
    "title": "8 Missing Data",
    "section": "Exploring Missing Data",
    "text": "Exploring Missing Data\nGuiding question: How can we use visualizations and tabulations to explore what missing data mechanisms may be at play?\nWe‚Äôll look at the airquality dataset available in base R, which gives daily air quality measurements in New York from May to September 1973. You can pull up the codebook with ?airquality in the Console.\n\nCodedata(airquality)",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>8 Missing Data</span>"
    ]
  },
  {
    "objectID": "src/ica/08-missing-data-notes.html#missingness-by-variable",
    "href": "src/ica/08-missing-data-notes.html#missingness-by-variable",
    "title": "8 Missing Data",
    "section": "Missingness by Variable",
    "text": "Missingness by Variable\nWe can explore how much missingness there is for each variable with the following functions:\n\nCodesummary(airquality) # Summary statistics in addition to number of NA's\n\n     Ozone           Solar.R           Wind             Temp      \n Min.   :  1.00   Min.   :  7.0   Min.   : 1.700   Min.   :56.00  \n 1st Qu.: 18.00   1st Qu.:115.8   1st Qu.: 7.400   1st Qu.:72.00  \n Median : 31.50   Median :205.0   Median : 9.700   Median :79.00  \n Mean   : 42.13   Mean   :185.9   Mean   : 9.958   Mean   :77.88  \n 3rd Qu.: 63.25   3rd Qu.:258.8   3rd Qu.:11.500   3rd Qu.:85.00  \n Max.   :168.00   Max.   :334.0   Max.   :20.700   Max.   :97.00  \n NA's   :37       NA's   :7                                       \n     Month            Day      \n Min.   :5.000   Min.   : 1.0  \n 1st Qu.:6.000   1st Qu.: 8.0  \n Median :7.000   Median :16.0  \n Mean   :6.993   Mean   :15.8  \n 3rd Qu.:8.000   3rd Qu.:23.0  \n Max.   :9.000   Max.   :31.0  \n                               \n\nCodenaniar::vis_miss(airquality) # Where are NA's located?\n\n\n\n\n\n\nCodenaniar::miss_var_summary(airquality) # Information from vis_miss() in table form\n\n# A tibble: 6 √ó 3\n  variable n_miss pct_miss\n  &lt;chr&gt;     &lt;int&gt;    &lt;num&gt;\n1 Ozone        37    24.2 \n2 Solar.R       7     4.58\n3 Wind          0     0   \n4 Temp          0     0   \n5 Month         0     0   \n6 Day           0     0",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>8 Missing Data</span>"
    ]
  },
  {
    "objectID": "src/ica/08-missing-data-notes.html#missingness-by-case",
    "href": "src/ica/08-missing-data-notes.html#missingness-by-case",
    "title": "8 Missing Data",
    "section": "Missingness by Case",
    "text": "Missingness by Case\nWe can explore how much missingness there is for each case with naniar::miss_case_summary(). For each case, this function calculates the number and percentage of variables with a missing value.\nImpact of Information: If the pct_miss column is large for a case, we likely won‚Äôt be able to impute any of its missing values because there just isn‚Äôt enough known information‚Äìthis case will have to be dropped from the analysis.\n\nCode# case is standing for row, case 5 = row 5\nnaniar::miss_case_summary(airquality)\n\n# A tibble: 153 √ó 3\n    case n_miss pct_miss\n   &lt;int&gt;  &lt;int&gt;    &lt;dbl&gt;\n 1     5      2     33.3\n 2    27      2     33.3\n 3     6      1     16.7\n 4    10      1     16.7\n 5    11      1     16.7\n 6    25      1     16.7\n 7    26      1     16.7\n 8    32      1     16.7\n 9    33      1     16.7\n10    34      1     16.7\n# ‚Ñπ 143 more rows",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>8 Missing Data</span>"
    ]
  },
  {
    "objectID": "src/ica/08-missing-data-notes.html#exploring-missingness-mechanisms",
    "href": "src/ica/08-missing-data-notes.html#exploring-missingness-mechanisms",
    "title": "8 Missing Data",
    "section": "Exploring Missingness Mechanisms",
    "text": "Exploring Missingness Mechanisms\nAssessing missingness mechanisms involves checking if missingness in a variable is related to other variables.\nNote: Through our available data, we are really only able to explore the potential for MCAR or MAR mechanisms.\nImpact of Information: There is always the chance that unobserved information (unobserved other variables or unobserved values of the variables we do have) is related to missingness for our variables, so to think through the potential for MNAR, more contextual information is necessary.\nTo explore these relationships, we can create TRUE/FALSE indicators of whether a variable is missing. In the plots below, we use is.na(Ozone) to explore whether cases with missing ozone values are noticeably different from cases with observed ozone values in terms of Solar.R.\n\nCodeggplot(airquality, aes(x = is.na(Ozone), y = Solar.R)) + \n    geom_boxplot()\n\n\n\n\n\n\nCodeggplot(airquality, aes(x = Solar.R, color = is.na(Ozone))) + \n    geom_density()\n\n\n\n\n\n\n\nThe above boxplots and density plots suggest that missing ozone is not strongly related to solar radiation levels.\nWe still should check if ozone missingness is related to the Wind, Temp, Month, and Day variables (to be done in Exercises).\nIn addition to checking if the chance of ozone missingness is related to Solar.R, we should check if the values of ozone could be predicted by Solar.R.\nIn the scaterrplot below, we look at the relationship between Ozone and Solar.R and use vertical lines to indicate the Solar.R values for cases that are missing Ozone.\n\n\nImpact of Information: We see that missing Ozone cases are within the observed span of Solar.R, so we would be ok with predicting Ozone from Solar.R because there would be no extrapolation.\n\n\nCodeggplot(airquality, aes(x = Solar.R, y = Ozone)) +\n    geom_point() +\n    geom_smooth() +\n    geom_vline(data = airquality |&gt; filter(is.na(Ozone)), mapping = aes(xintercept = Solar.R))",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>8 Missing Data</span>"
    ]
  },
  {
    "objectID": "src/ica/08-missing-data-notes.html#exercises",
    "href": "src/ica/08-missing-data-notes.html#exercises",
    "title": "8 Missing Data",
    "section": "Exercises",
    "text": "Exercises\n\n\nMechanism detection practice Look at the boxplot + scatterplot pairs for Alternate Situations 1 and 2 below. How do these situations compare to our actual situation and to each other? What concerns might arise from using a model to impute Ozone?\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nOzone mechanism detection Continue the investigation of missingness for Ozone.\n\nWe want to see how Month, Wind, and Temp relate to the chance of missingness for Ozone and to the value of Ozone.\nDoes it look like a linear regression model (perhaps with variable transformations) could be effective in imputing the missing ozone data?\n\nCodeggplot(airquality, aes(fill = is.na(Ozone), x = factor(Month))) +\n    geom_bar(position = \"fill\")\n\n\n\n\n\n\nCodeggplot(airquality, aes(x = is.na(Ozone), y = Wind)) +\n    geom_boxplot()\n\n\n\n\n\n\nCodeggplot(airquality, aes(x = is.na(Ozone), y = Temp)) +\n    geom_boxplot()\n\n\n\n\n\n\nCodeggplot(airquality, aes(x = factor(Month), y = Ozone)) +\n    geom_boxplot()\n\n\n\n\n\n\nCodeggplot(airquality, aes(x = Wind, y = Ozone)) +\n    geom_point() +\n    geom_smooth() +\n    geom_vline(data = airquality |&gt; filter(is.na(Ozone)), mapping = aes(xintercept = Wind))\n\n\n\n\n\n\nCodeggplot(airquality, aes(x = Temp, y = Ozone)) +\n    geom_point() +\n    geom_smooth() +\n    geom_vline(data = airquality |&gt; filter(is.na(Ozone)), mapping = aes(xintercept = Temp))",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>8 Missing Data</span>"
    ]
  },
  {
    "objectID": "src/ica/08-missing-data-notes.html#regression-imputation",
    "href": "src/ica/08-missing-data-notes.html#regression-imputation",
    "title": "8 Missing Data",
    "section": "Regression Imputation",
    "text": "Regression Imputation\nWhen a model is built and used to generate a single set of predictions for missing values, this is known as single imputation.\n\nWhen using singly imputed data in subsequent modeling, the uncertainty in estimates tends to be underestimated. This means that:\n\nStandard errors are lower than they should be.\nConfidence intervals won‚Äôt contain the true parameter value the ‚Äúadvertised‚Äù percentage of times\n\ne.g., 95% confidence intervals will not contain the truth in 95% of samples‚Äìthe coverage probability will be less than 95%\n\n\n\n\n\nIn multiple imputation, multiple imputed datasets are generated with different values for the filled-in data.\n\nSubsequent models are fit on each of these datasets, and both estimates and uncertainty measures are pooled across all of these fits.\nMultiple imputation more accurately estimates uncertainty measures.",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>8 Missing Data</span>"
    ]
  },
  {
    "objectID": "src/ica/08-missing-data-notes.html#simulation-studies",
    "href": "src/ica/08-missing-data-notes.html#simulation-studies",
    "title": "8 Missing Data",
    "section": "Simulation Studies",
    "text": "Simulation Studies\nWe can use a simulation study to investigate the statistical properties described above.\n\n\nGenerate (simulate) data where we are in control of missing data mechanisms and the true relationship between an outcome and the predictors.\nOn that simulated data, use single imputation to fill in the missing values. Fit the desired model, and obtain a confidence interval for a coefficient of interest.\nOn that simulated data, use multiple imputation to fill in the missing values. Fit the desired models on all imputed datasets, pool results, and obtain a confidence interval for a coefficient of interest.\nSteps 1 - 3 are repeated a lot of times (num_simulations &lt;- 1000) to see how things work out in lots of different samples.\nSummarize the performance of single and multiple imputation across the num_simulations simulations.\n\n\nWe will slowly step through the simulation study code below. We will pause frequently for you to add comments documenting what is happening.\n\nCodeset.seed(224)\nnum_simulations &lt;- 1000\nci_list &lt;- vector(\"list\", length = num_simulations)\n\nsystem.time({\nfor (i in 1:num_simulations) {\n    # Simulate data\n    n &lt;- 1000\n    sim_data &lt;- tibble(\n        x1 = runif(n, min = 0, max = 1),\n        x2 = x1 + rnorm(n, mean = 0, sd = 1),\n        x2_miss_bool = rbinom(n, size = 1, prob = x1/2),\n        x2_NA = if_else(x2_miss_bool == 1, NA, x2),\n        y = x1 + x2 + rnorm(n, mean = 0, sd = 1)\n    )\n    \n    # Single imputation ---------------\n    mice_obj &lt;- mice(sim_data |&gt; select(x1, x2_NA, y), m = 1, method = \"norm\", printFlag = FALSE)\n    si_mod &lt;- with(mice_obj, lm(y ~ x1 + x2_NA))\n    ci_single &lt;- si_mod$analyses[[1]] |&gt; confint(level = 0.95)\n    ci_single &lt;- ci_single[\"x2_NA\",]\n    \n    # Multiple imputation -------------\n    mice_obj &lt;- mice(sim_data |&gt; select(x1, x2_NA, y), m = 10, method = \"norm\", printFlag = FALSE)\n    mi_mods &lt;- with(mice_obj, lm(y ~ x1 + x2_NA))\n    pooled_res &lt;- pool(mi_mods)\n    summ_pooled_res &lt;- summary(pooled_res, conf.int = TRUE, conf.level = 0.95)\n    ci_multiple_lower &lt;- summ_pooled_res |&gt; filter(term==\"x2_NA\") |&gt; pull(`2.5 %`)\n    ci_multiple_upper &lt;- summ_pooled_res |&gt; filter(term==\"x2_NA\") |&gt; pull(`97.5 %`)\n    \n    # Store CI information\n    ci_list[[i]] &lt;- tibble(\n        ci_lower = c(\n            ci_single[1],\n            ci_multiple_lower\n        ),\n        ci_upper = c(\n            ci_single[2],\n            ci_multiple_upper\n        ),\n        which_imp = c(\"single\", \"multiple\")\n    )\n}\n})\n\n   user  system elapsed \n107.449   1.508 109.035 \n\n\nBelow we compute the confidence interval (CI) coverage probability (fraction of times the CI contains the true value of 1) for the CIs generated from single and multiple imputation:\n\nCodeci_data &lt;- bind_rows(ci_list)\nci_data |&gt; \n    mutate(contains_truth = ci_lower &lt; 1 & ci_upper &gt; 1) |&gt; \n    group_by(which_imp) |&gt; \n    summarize(frac_contains_truth = mean(contains_truth))\n\n# A tibble: 2 √ó 2\n  which_imp frac_contains_truth\n  &lt;chr&gt;                   &lt;dbl&gt;\n1 multiple                0.947\n2 single                  0.902",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>8 Missing Data</span>"
    ]
  },
  {
    "objectID": "src/ica/08-missing-data-notes.html#done",
    "href": "src/ica/08-missing-data-notes.html#done",
    "title": "8 Missing Data",
    "section": "Done!",
    "text": "Done!\n\nCheck the ICA Instructions for how to (a) push your code to GitHub and (b) update your portfolio website",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>8 Missing Data</span>"
    ]
  },
  {
    "objectID": "src/ica/11-iteration-1-notes.html",
    "href": "src/ica/11-iteration-1-notes.html",
    "title": "11 Loops+Iter P1",
    "section": "",
    "text": "üß© Learning Goals\nBy the end of this lesson, you should be able to:",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>10</span>¬† <span class='chapter-title'>11 Loops+Iter P1</span>"
    ]
  },
  {
    "objectID": "src/ica/11-iteration-1-notes.html#learning-goals",
    "href": "src/ica/11-iteration-1-notes.html#learning-goals",
    "title": "11 Loops+Iter P1",
    "section": "",
    "text": "Write a for loop in R to handle repeated tasks\n\nUse seq_along() and seq_len() to iterate over vectors or rows of a data frame\nStore output from a for loop in a list or other storage container\n\n\nRecognize that vectorized functions help us avoid for loops in many situations\nUse the across() function to wrangle multiple variables simultaneously",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>10</span>¬† <span class='chapter-title'>11 Loops+Iter P1</span>"
    ]
  },
  {
    "objectID": "src/ica/11-iteration-1-notes.html#iteration",
    "href": "src/ica/11-iteration-1-notes.html#iteration",
    "title": "11 Loops+Iter P1",
    "section": "Iteration",
    "text": "Iteration\nWhen we want to reuse code, we can use:\n\nfunctions to save the steps of the task\niteration to apply that function to new inputs\n\nLet‚Äôs talk about iteration in R.\n\nIterating using a for loop & how to do it appropriately in R (today)\nIterating across data frame columns (today)\nIterating using map and walk for iteration, instead of a for loop (next class)",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>10</span>¬† <span class='chapter-title'>11 Loops+Iter P1</span>"
    ]
  },
  {
    "objectID": "src/ica/11-iteration-1-notes.html#purposes-of-iteration",
    "href": "src/ica/11-iteration-1-notes.html#purposes-of-iteration",
    "title": "11 Loops+Iter P1",
    "section": "Purposes of Iteration",
    "text": "Purposes of Iteration\nCreating or saving a new object\n\nPerforming an action with a return output\nEx. creating new variables/datasets, fitting models, etc.\nWe‚Äôll need to consider storage (memory allocation).\nNext class, we‚Äôll use map() for this‚Ä¶\n\nSide effects\n\nPerforming an action without a R return output\nEx: saving data using write_csv() or saving a plot with png()\n\nWe don‚Äôt need to worry about storage in R.\nWe could use walk() for this‚Ä¶\n\n\nCodelibrary(tidyverse)",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>10</span>¬† <span class='chapter-title'>11 Loops+Iter P1</span>"
    ]
  },
  {
    "objectID": "src/ica/11-iteration-1-notes.html#for-loops",
    "href": "src/ica/11-iteration-1-notes.html#for-loops",
    "title": "11 Loops+Iter P1",
    "section": "\nfor loops",
    "text": "for loops\nIn R, for loops have the following general structure:\n\nCodefor (i in some_vector) {\n    # Code to do stuff based on i\n}\n\n\nsome_vector can be any vector, including:\n\nAn indexing integer vector: 1:3 [Most common!]\nA character vector: c(\"group1\", \"group2\", \"group3\")\n\nA vector of any other class\n\n\nCodegroups &lt;- c(\"group1\", \"group2\", \"group3\") # a vector to iterate over\n \nfor (i in 1:3) { # i: index\n    print(groups[i])\n}\n\n[1] \"group1\"\n[1] \"group2\"\n[1] \"group3\"\n\nCodefor (g in groups) { # iterating over the vector\n    print(g)\n}\n\n[1] \"group1\"\n[1] \"group2\"\n[1] \"group3\"\n\n\nTo iterate over an indexing vector, it is useful to know about the following two functions:\n\n\nseq_along(v): generates an integer sequence from 1 to the length of the vector v supplied\n\nseq_len(n): generates an integer sequence from 1 to n\n\n\n\nCodefor (i in seq_along(groups)) {\n    print(groups[i])\n}\n\n[1] \"group1\"\n[1] \"group2\"\n[1] \"group3\"\n\nCodefor (i in seq_len(length(groups))) {\n    print(groups[i])\n}\n\n[1] \"group1\"\n[1] \"group2\"\n[1] \"group3\"\n\n\nA nice feature of seq_along() is that it generates an empty iteration vector if the vector you‚Äôre iterating over itself has length 0.\n\nCodeno_groups &lt;- c()\nseq_along(no_groups)\n\ninteger(0)\n\nCodefor (i in seq_along(no_groups)) {\n    print(no_groups[i])\n}\n\n\nseq_len() is useful for iterating over the rows of a data frame because seq_along() would iterate over columns:\n\nCodesmall_data &lt;- tibble(a = 1:2, b = 2:3, c = 4:5)\n\nfor (col in small_data) { # each element is the column \n    print(col)\n}\n\n[1] 1 2\n[1] 2 3\n[1] 4 5\n\nCodefor (r in seq_len(nrow(small_data))) {\n    print(r)\n}\n\n[1] 1\n[1] 2\n\n\nIndexing is particularly important when we want to create/save new objects as we need to store output created during a for loop.\n\n\n\n\n\n\nWhen using a for loop to create/save output, we should create storage containers ahead of time with the vector() function. This allocates memory for the output and is a more efficient use of memory.\n\n\n\n\nCodechar_storage &lt;- vector(\"character\", length = 3)\nnum_storage &lt;- vector(\"numeric\", length = 3)\nlist_storage &lt;- vector(\"list\", length = 3)\n\nchar_storage\n\n[1] \"\" \"\" \"\"\n\nCodenum_storage\n\n[1] 0 0 0\n\nCodelist_storage\n\n[[1]]\nNULL\n\n[[2]]\nNULL\n\n[[3]]\nNULL\n\nCodefor (i in seq_len(3)) {\n    char_storage[i] &lt;- str_c(\"Number: \", i)\n    num_storage[i] &lt;- 2*i\n    list_storage[[i]] &lt;- i # Note the [[ for subsetting here\n}\n\nchar_storage\n\n[1] \"Number: 1\" \"Number: 2\" \"Number: 3\"\n\nCodenum_storage\n\n[1] 2 4 6\n\nCodelist_storage\n\n[[1]]\n[1] 1\n\n[[2]]\n[1] 2\n\n[[3]]\n[1] 3\n\n\n\nfor loops and memory allocation\nIf you don‚Äôt create a storage container ahead of time, you will regret it. Let‚Äôs bench mark our code to see the difference!\n\nCode# Example 1: No storage container; append new value to existing vector\nlibrary(bench)\nx &lt;- integer()\n\nbench::mark(\n  for (i in 1:1e5) {\n    x &lt;- c(x, i)\n  }\n)\n\n# A tibble: 1 √ó 6\n  expression                             min median `itr/sec` mem_alloc `gc/sec`\n  &lt;bch:expr&gt;                          &lt;bch:&gt; &lt;bch:&gt;     &lt;dbl&gt; &lt;bch:byt&gt;    &lt;dbl&gt;\n1 for (i in 1:1e+05) { x &lt;- c(x, i) }  27.4s  27.4s    0.0364    18.6GB     45.8\n\nCode# Example 2: Using a storage container!\n#Notice median (time to run), mem_alloc (how much memory you are using), and gc (garbage collection)\nx &lt;- vector('integer', length = 1e5)\nbench::mark(\n  for (i in 1:1e5) {\n    x[i] &lt;- i\n  }\n)\n\n# A tibble: 1 √ó 6\n  expression                            min  median `itr/sec` mem_alloc `gc/sec`\n  &lt;bch:expr&gt;                       &lt;bch:tm&gt; &lt;bch:t&gt;     &lt;dbl&gt; &lt;bch:byt&gt;    &lt;dbl&gt;\n1 for (i in 1:1e+05) { x[i] &lt;- i }   3.69ms  3.75ms      265.     402KB     4.10\n\nCode# Example 3: Vectorized function\n#Notice median (time to run), mem_alloc (how much memory you are using), and gc (garbage collection)\nbench::mark(\n  x &lt;- seq(1, 1e5, by = 1)\n)\n\n# A tibble: 1 √ó 6\n  expression                      min   median `itr/sec` mem_alloc `gc/sec`\n  &lt;bch:expr&gt;                 &lt;bch:tm&gt; &lt;bch:tm&gt;     &lt;dbl&gt; &lt;bch:byt&gt;    &lt;dbl&gt;\n1 x &lt;- seq(1, 1e+05, by = 1)    420¬µs    532¬µs     1863.    1.91MB     54.9",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>10</span>¬† <span class='chapter-title'>11 Loops+Iter P1</span>"
    ]
  },
  {
    "objectID": "src/ica/11-iteration-1-notes.html#exercises",
    "href": "src/ica/11-iteration-1-notes.html#exercises",
    "title": "11 Loops+Iter P1",
    "section": "Exercises",
    "text": "Exercises\nPair programming exercises: Whoever has most recently eaten dessert (broadly interpreted) should be the driver first. Switch after Exercise 2.\nWrite for-loops that do each of the following:\n\nPrints the even numbers from 2:20\n\nThen, produce the same output with the seq() function\n\n\n\n\nCode# for loop\nfor (i in seq_len(10)) {\n    print(2*i)\n}\n\n[1] 2\n[1] 4\n[1] 6\n[1] 8\n[1] 10\n[1] 12\n[1] 14\n[1] 16\n[1] 18\n[1] 20\n\nCode# for (i in seq(2, 20, by=2)) {\n#     print(2*i)\n# }\n\n# vectorized approach with `seq()`\nseq(from = 2, to = 20, by = 2)\n\n [1]  2  4  6  8 10 12 14 16 18 20\n\n\n\nIterates over the month.name vector and stores a character vector of output containing strings like ‚ÄúMonth 1: January‚Äù, ‚ÄúMonth 2: February‚Äù.\n\nThen, produce the same output with str_c() only.\n\n\n\n\nCode# for loop\n\nfor (name in month.name){\n  i = i + 1\n  print(str_c(\"Month \", i, \": \", name))\n}\n\n[1] \"Month 11: January\"\n[1] \"Month 12: February\"\n[1] \"Month 13: March\"\n[1] \"Month 14: April\"\n[1] \"Month 15: May\"\n[1] \"Month 16: June\"\n[1] \"Month 17: July\"\n[1] \"Month 18: August\"\n[1] \"Month 19: September\"\n[1] \"Month 20: October\"\n[1] \"Month 21: November\"\n[1] \"Month 22: December\"\n\nCode# vectorized approach with `str_c()`\nstr_c(\"Month\",\" \", seq(1,12),\": \", month.name)\n\n [1] \"Month 1: January\"   \"Month 2: February\"  \"Month 3: March\"    \n [4] \"Month 4: April\"     \"Month 5: May\"       \"Month 6: June\"     \n [7] \"Month 7: July\"      \"Month 8: August\"    \"Month 9: September\"\n[10] \"Month 10: October\"  \"Month 11: November\" \"Month 12: December\"\n\n\n\nOn the diamonds dataset, fit stratified models of price vs.¬†carat, model separately estimated for each value of cut, and store the fitted models in a list storage container.\n\n\nCode# for loop\n# Fit models of price vs. carat separately for each value of cut\nunique_cuts &lt;- diamonds |&gt; pull(cut) |&gt; levels()\nlin_mod_results &lt;- vector(mode = \"list\", length = length(unique_cuts))\n\ndiamonds\n\n# A tibble: 53,940 √ó 10\n   carat cut       color clarity depth table price     x     y     z\n   &lt;dbl&gt; &lt;ord&gt;     &lt;ord&gt; &lt;ord&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n 1  0.23 Ideal     E     SI2      61.5    55   326  3.95  3.98  2.43\n 2  0.21 Premium   E     SI1      59.8    61   326  3.89  3.84  2.31\n 3  0.23 Good      E     VS1      56.9    65   327  4.05  4.07  2.31\n 4  0.29 Premium   I     VS2      62.4    58   334  4.2   4.23  2.63\n 5  0.31 Good      J     SI2      63.3    58   335  4.34  4.35  2.75\n 6  0.24 Very Good J     VVS2     62.8    57   336  3.94  3.96  2.48\n 7  0.24 Very Good I     VVS1     62.3    57   336  3.95  3.98  2.47\n 8  0.26 Very Good H     SI1      61.9    55   337  4.07  4.11  2.53\n 9  0.22 Fair      E     VS2      65.1    61   337  3.87  3.78  2.49\n10  0.23 Very Good H     VS1      59.4    61   338  4     4.05  2.39\n# ‚Ñπ 53,930 more rows\n\nCodefor (i in unique(diamonds$cut)) {\n  print(i)\n  \n}\n\n[1] \"Ideal\"\n[1] \"Premium\"\n[1] \"Good\"\n[1] \"Very Good\"\n[1] \"Fair\"\n\n\n\nCodedata(diamonds)\n\n# Fit models of price vs. carat separately for each value of cut\nunique_cuts &lt;- diamonds |&gt; pull(cut) |&gt; levels()\nlin_mod_results &lt;- vector(mode = \"list\", length = length(unique_cuts))\n\nfor (i in seq_along(unique_cuts)) {\n    this_cut &lt;- unique_cuts[i]\n    diamonds_sub &lt;- diamonds |&gt;\n        filter(cut==this_cut)\n    # The double square brackets [[i]] accesses the ith element of a list\n    lin_mod_results[[i]] &lt;- lm(price ~ carat, data = diamonds_sub)\n}",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>10</span>¬† <span class='chapter-title'>11 Loops+Iter P1</span>"
    ]
  },
  {
    "objectID": "src/ica/11-iteration-1-notes.html#iteration-across-data-frame-columns",
    "href": "src/ica/11-iteration-1-notes.html#iteration-across-data-frame-columns",
    "title": "11 Loops+Iter P1",
    "section": "Iteration across data frame columns",
    "text": "Iteration across data frame columns\nOften we will have to perform the same data wrangling on many variables (e.g., rounding numbers)\n\nCodediamonds |&gt;\n    mutate(\n        carat = round(carat, 1),\n        x = round(x, 1),\n        y = round(y, 1),\n        z = round(z, 1)\n    )\n\n# A tibble: 53,940 √ó 10\n   carat cut       color clarity depth table price     x     y     z\n   &lt;dbl&gt; &lt;ord&gt;     &lt;ord&gt; &lt;ord&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n 1   0.2 Ideal     E     SI2      61.5    55   326   4     4     2.4\n 2   0.2 Premium   E     SI1      59.8    61   326   3.9   3.8   2.3\n 3   0.2 Good      E     VS1      56.9    65   327   4     4.1   2.3\n 4   0.3 Premium   I     VS2      62.4    58   334   4.2   4.2   2.6\n 5   0.3 Good      J     SI2      63.3    58   335   4.3   4.3   2.8\n 6   0.2 Very Good J     VVS2     62.8    57   336   3.9   4     2.5\n 7   0.2 Very Good I     VVS1     62.3    57   336   4     4     2.5\n 8   0.3 Very Good H     SI1      61.9    55   337   4.1   4.1   2.5\n 9   0.2 Fair      E     VS2      65.1    61   337   3.9   3.8   2.5\n10   0.2 Very Good H     VS1      59.4    61   338   4     4     2.4\n# ‚Ñπ 53,930 more rows\n\n\ndplyr provides the across() function for performing these repeated function calls:\n\nCode# Option 1: Create our own named function\nround_to_one &lt;- function(x) {\n    round(x, digits = 1)\n}\ndiamonds |&gt; \n    mutate(across(.cols = c(carat, x, y, z), .fns = round_to_one))\n\n# A tibble: 53,940 √ó 10\n   carat cut       color clarity depth table price     x     y     z\n   &lt;dbl&gt; &lt;ord&gt;     &lt;ord&gt; &lt;ord&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n 1   0.2 Ideal     E     SI2      61.5    55   326   4     4     2.4\n 2   0.2 Premium   E     SI1      59.8    61   326   3.9   3.8   2.3\n 3   0.2 Good      E     VS1      56.9    65   327   4     4.1   2.3\n 4   0.3 Premium   I     VS2      62.4    58   334   4.2   4.2   2.6\n 5   0.3 Good      J     SI2      63.3    58   335   4.3   4.3   2.8\n 6   0.2 Very Good J     VVS2     62.8    57   336   3.9   4     2.5\n 7   0.2 Very Good I     VVS1     62.3    57   336   4     4     2.5\n 8   0.3 Very Good H     SI1      61.9    55   337   4.1   4.1   2.5\n 9   0.2 Fair      E     VS2      65.1    61   337   3.9   3.8   2.5\n10   0.2 Very Good H     VS1      59.4    61   338   4     4     2.4\n# ‚Ñπ 53,930 more rows\n\n\n\nCode# Option 2: Use an \"anonymous\" or \"lambda\" function that isn't named/saved\ndiamonds |&gt; \n    mutate(across(.cols = c(carat, x, y, z), .fns = function(x) {round(x, digits = 1)} ))\n\n# A tibble: 53,940 √ó 10\n   carat cut       color clarity depth table price     x     y     z\n   &lt;dbl&gt; &lt;ord&gt;     &lt;ord&gt; &lt;ord&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n 1   0.2 Ideal     E     SI2      61.5    55   326   4     4     2.4\n 2   0.2 Premium   E     SI1      59.8    61   326   3.9   3.8   2.3\n 3   0.2 Good      E     VS1      56.9    65   327   4     4.1   2.3\n 4   0.3 Premium   I     VS2      62.4    58   334   4.2   4.2   2.6\n 5   0.3 Good      J     SI2      63.3    58   335   4.3   4.3   2.8\n 6   0.2 Very Good J     VVS2     62.8    57   336   3.9   4     2.5\n 7   0.2 Very Good I     VVS1     62.3    57   336   4     4     2.5\n 8   0.3 Very Good H     SI1      61.9    55   337   4.1   4.1   2.5\n 9   0.2 Fair      E     VS2      65.1    61   337   3.9   3.8   2.5\n10   0.2 Very Good H     VS1      59.4    61   338   4     4     2.4\n# ‚Ñπ 53,930 more rows\n\nCode# Anonymous functions can be written in a more concise way\n# function(x){ length(unique(x)) } OR ~ length(unique(.x))\n# function(x,y){ length(unique(x + y)) } OR ~ length(unique(.x + .y))\n\n\nWhen we look at the documentation for across(), we see that the .cols argument specifies which variables we want to transform, and it has a &lt;tidy-select&gt; tag. This means that the syntax we use for .cols follows certain rules.\nLet‚Äôs click this link to explore the possibilities for selecting variables.\n\nRead through the ‚ÄúOverview of selection features‚Äù section to get an overall sense of the many ways to select variables.\nNavigate back to the across() documentation and read through the Examples section at the bottom. Click the ‚ÄúRun examples‚Äù link to view the output for all of the examples.\n\nWhat if we wanted to perform multiple transformations on each of many variables?\nWithin the different values of diamond cut, let‚Äôs summarize the mean, median, and standard deviation of the numeric variables. When we look at the .fns argument in the across() documentation, we see that we can provide a list of functions:\n\nCodediamonds |&gt;\n    group_by(cut) |&gt; \n    summarize(across(.cols = where(is.numeric), .fns = list(mean = mean, med = median, sd = sd)))\n\n# A tibble: 5 √ó 22\n  cut     carat_mean carat_med carat_sd depth_mean depth_med depth_sd table_mean\n  &lt;ord&gt;        &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;\n1 Fair         1.05       1       0.516       64.0      65      3.64        59.1\n2 Good         0.849      0.82    0.454       62.4      63.4    2.17        58.7\n3 Very G‚Ä¶      0.806      0.71    0.459       61.8      62.1    1.38        58.0\n4 Premium      0.892      0.86    0.515       61.3      61.4    1.16        58.7\n5 Ideal        0.703      0.54    0.433       61.7      61.8    0.719       56.0\n# ‚Ñπ 14 more variables: table_med &lt;dbl&gt;, table_sd &lt;dbl&gt;, price_mean &lt;dbl&gt;,\n#   price_med &lt;dbl&gt;, price_sd &lt;dbl&gt;, x_mean &lt;dbl&gt;, x_med &lt;dbl&gt;, x_sd &lt;dbl&gt;,\n#   y_mean &lt;dbl&gt;, y_med &lt;dbl&gt;, y_sd &lt;dbl&gt;, z_mean &lt;dbl&gt;, z_med &lt;dbl&gt;,\n#   z_sd &lt;dbl&gt;\n\n\nWhat does the list of functions look like? What is the structure of this list object?\n\nCodelist_of_fcts &lt;- list(mean = mean, med = median, sd = sd)\nlist_of_fcts\n\n$mean\nfunction (x, ...) \nUseMethod(\"mean\")\n&lt;bytecode: 0x104955258&gt;\n&lt;environment: namespace:base&gt;\n\n$med\nfunction (x, na.rm = FALSE, ...) \nUseMethod(\"median\")\n&lt;bytecode: 0x116cc5940&gt;\n&lt;environment: namespace:stats&gt;\n\n$sd\nfunction (x, na.rm = FALSE) \nsqrt(var(if (is.vector(x) || is.factor(x)) x else as.double(x), \n    na.rm = na.rm))\n&lt;bytecode: 0x10679e968&gt;\n&lt;environment: namespace:stats&gt;\n\nCodestr(list_of_fcts)\n\nList of 3\n $ mean:function (x, ...)  \n $ med :function (x, na.rm = FALSE, ...)  \n $ sd  :function (x, na.rm = FALSE)",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>10</span>¬† <span class='chapter-title'>11 Loops+Iter P1</span>"
    ]
  },
  {
    "objectID": "src/ica/11-iteration-1-notes.html#exercises-1",
    "href": "src/ica/11-iteration-1-notes.html#exercises-1",
    "title": "11 Loops+Iter P1",
    "section": "Exercises",
    "text": "Exercises\nUsing the diamonds dataset:\n\nTransform the x, y, and z columns so that the units of millimeters are displayed (e.g., ‚Äú4.0 mm‚Äù).\n\n\nConvert all numeric columns into character columns.\n\nHint: type is. and hit Tab in the Console. Scroll through the function options. Do the same with as.",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>10</span>¬† <span class='chapter-title'>11 Loops+Iter P1</span>"
    ]
  },
  {
    "objectID": "src/ica/11-iteration-1-notes.html#case-study-performing-many-different-versions-of-an-analysis",
    "href": "src/ica/11-iteration-1-notes.html#case-study-performing-many-different-versions-of-an-analysis",
    "title": "11 Loops+Iter P1",
    "section": "Case study: performing many different versions of an analysis",
    "text": "Case study: performing many different versions of an analysis\nOne of my most common use cases for writing functions and iteration/looping is to perform some exploration or modeling repeatedly for several different ‚Äúsettings‚Äù.\nFor example, our broad goal might be to fit a linear regression model to our data. However, there are often multiple choices that we have to make in practice:\n\nKeep missing values or fill them in (imputation)?\nFit the model only on a certain group of cases?\nFilter out outliers in one or more variables?\nTransform certain variables? (e.g., log transformation)\n\nWe can map any number of these choices to arguments in a custom model-fitting function:\n\n\nimpute: TRUE or FALSE\n\nfilter_to: This could be a string description like ‚ÄúAll cases‚Äù, ‚ÄúGroup 1‚Äù, or ‚ÄúGroups 1 and 2‚Äù\n\n\nCodefit_model &lt;- function(data, impute, filter_to) {\n    if (impute) {\n        data &lt;- some_imputation_function(data)\n    }\n    \n    if (filter_to==\"Group 1\") {\n        data &lt;- data |&gt; \n            filter(group == 1)\n    } else if (filter_to == \"Groups 1 and 2\") {\n        data &lt;- data |&gt; \n            filter(group %in% c(1,2))\n    }\n    \n    lm(y ~ x1 + x2, data = data)\n}\n\n\nThe tidyr package has a useful function called crossing() that is useful for generating argument combinations.\nFor each argument, we specify all possible values for that argument. crossing() generates all combinations:\n\nCodedf_arg_combos &lt;- crossing(\n    impute = c(TRUE, FALSE),\n    filter_to = c(\"All cases\", \"Group 1\", \"Groups 1 and 2\")\n)\ndf_arg_combos\n\n# A tibble: 6 √ó 2\n  impute filter_to     \n  &lt;lgl&gt;  &lt;chr&gt;         \n1 FALSE  All cases     \n2 FALSE  Group 1       \n3 FALSE  Groups 1 and 2\n4 TRUE   All cases     \n5 TRUE   Group 1       \n6 TRUE   Groups 1 and 2\n\nCode# Another example\ncrossing(\n    option1 = 1:3,\n    option2 = c(TRUE, FALSE),\n    option3 = c(\"low\", \"medium\", \"high\")\n)\n\n# A tibble: 18 √ó 3\n   option1 option2 option3\n     &lt;int&gt; &lt;lgl&gt;   &lt;chr&gt;  \n 1       1 FALSE   high   \n 2       1 FALSE   low    \n 3       1 FALSE   medium \n 4       1 TRUE    high   \n 5       1 TRUE    low    \n 6       1 TRUE    medium \n 7       2 FALSE   high   \n 8       2 FALSE   low    \n 9       2 FALSE   medium \n10       2 TRUE    high   \n11       2 TRUE    low    \n12       2 TRUE    medium \n13       3 FALSE   high   \n14       3 FALSE   low    \n15       3 FALSE   medium \n16       3 TRUE    high   \n17       3 TRUE    low    \n18       3 TRUE    medium \n\n\nWith iteration in our toobox, we can iterate the fit_model() function over the combinations in df_arg_combos.",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>10</span>¬† <span class='chapter-title'>11 Loops+Iter P1</span>"
    ]
  },
  {
    "objectID": "src/ica/11-iteration-1-notes.html#exercises-2",
    "href": "src/ica/11-iteration-1-notes.html#exercises-2",
    "title": "11 Loops+Iter P1",
    "section": "Exercises",
    "text": "Exercises\nGoal: In the diamonds dataset, we want to understand the relationship between price and size (carat). We want to explore variation along two choices:\n\nThe variables included in the model. We‚Äôll explore 3 sets of variables:\n\nNo further variables (just price and carat)\nAdjusting for cut\n\nAdjusting for cut and clarity\n\nAdjusting for cut, clarity, and color\n\n\n\nWhether or not to remove outliers in the carat variable. We‚Äôll define outliers as cases whose carat is over 3 SDs away from the mean.\n\nWork with your partner on the following exercises. As you work, make note of what is challenging and any helpful thought processes/strategies that arise from the collaboration.\n\nUse crossing() to create the data frame of argument combinations for our analyses. Call it df_arg_combos. Note that you can create a list of formula objects in R with c(y ~ x1, y ~ x1 + x2). (Something like this will be the right hand side of an argument to crossing().)\n\n\nWrite a function called remove_outliers that removes outliers in a dataset. The user should be able to supply the dataset (data), the variable to remove outliers in (what_var), and a threshold on the number of SDs away from the mean used to define outliers (sd_thresh). Write your function so that it runs as follows: remove_outliers(diamonds, what_var = carat, sd_thresh = 3).\n\n\nWrite a function called fit_model that implements the different settings for our diamonds analysis.\n\n\nCodefit_model &lt;- function(data, mod_formula, remove_outliers) {\n    # remove_outliers is a TRUE/FALSE flag of whether or not to remove outliers\n    # This function implements our specific use case: outliers are cases that are 3 SDs away from the mean for the carat variable\n    \n    # Use mod_formula as the first argument of lm()\n}\n\n\n\nWrite a for loop that stores the fitted linear models from all versions of the analysis.\n\nRecall that you can pull out the contents of a single data frame column in many ways. For a data frame df with a variable named x:\n\ndf$x\ndf |&gt; pull(x)\ndf[[\"x\"]]\n\nNote that in df_arg_combos:\n\n\nmod_formula: this column is a list and you can extract the 1st element with [[1]]\n\n\nremove_outliers: this column is a vector and you can extract the 1st element with [1]",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>10</span>¬† <span class='chapter-title'>11 Loops+Iter P1</span>"
    ]
  },
  {
    "objectID": "src/ica/11-iteration-1-notes.html#done",
    "href": "src/ica/11-iteration-1-notes.html#done",
    "title": "11 Loops+Iter P1",
    "section": "Done!",
    "text": "Done!\n\nCheck the ICA Instructions for how to (a) push your code to GitHub and (b) update your portfolio website",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>10</span>¬† <span class='chapter-title'>11 Loops+Iter P1</span>"
    ]
  },
  {
    "objectID": "src/ica/15-scraping-notes.html",
    "href": "src/ica/15-scraping-notes.html",
    "title": "15 Web scraping",
    "section": "",
    "text": "üß© Learning Goals\nBy the end of this lesson, you should be able to: - Use CSS Selectors and the Selector Gadget tool to locate data of interest within a webpage - Use the html_elements(), html_text(), and html_attr() functions within the rvest packages to scrape data from webpage using CSS selectors.",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>11</span>¬† <span class='chapter-title'>15 Web scraping</span>"
    ]
  },
  {
    "objectID": "src/ica/15-scraping-notes.html#when-to-use",
    "href": "src/ica/15-scraping-notes.html#when-to-use",
    "title": "15 Web scraping",
    "section": "When to Use",
    "text": "When to Use\nWe have talked about how to acquire data from APIs. Whenever an API is available for your project, you should default to getting data from the API. Sometimes an API will not be available, and web scraping is another means of getting data.\nWeb scraping describes the use of code to extract information displayed on a web page. In R, the rvest package offers tools for scraping. (rvest is meant to sound like ‚Äúharvest‚Äù.)",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>11</span>¬† <span class='chapter-title'>15 Web scraping</span>"
    ]
  },
  {
    "objectID": "src/ica/15-scraping-notes.html#ethics",
    "href": "src/ica/15-scraping-notes.html#ethics",
    "title": "15 Web scraping",
    "section": "Ethics",
    "text": "Ethics\nrobots.txt is a file that some websites includes to clarify what can and cannot be scraped in addition to other constraints about scraping. When a website includes this file, we need to comply with the information in it for moral and legal reasons.\nWe will look through the information in ZenRows Tutorial How to Read robots.txt for Web Scraping and apply this to the NIH robots.txt file.\nFrom our investigation of the NIH robots.txt, we learn:\n\n\nUser-agent: *: Anyone is allowed to scrape\nNo Crawl-delay entry: no restriction on the scraping speed\nNo Visit-time entry: no restrictions on time of day that scraping is allowed\nNo Request-rate entry: no restrictions on simultaneous requests\nNo mention of ?page=, news-events, news-releases, or https://science.education.nih.gov/ in the Disallow sections. (This is what we want to scrape today.)\n\nFurther considerations\nThe Towards Data Science article Ethics in Web Scraping‚Äìnot available as of 10/24/2025 :( describes some good principles to ensure that we are valuing the labor that website owners invested to provide data and creating good from the information we do scrape.",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>11</span>¬† <span class='chapter-title'>15 Web scraping</span>"
    ]
  },
  {
    "objectID": "src/ica/15-scraping-notes.html#html-structure",
    "href": "src/ica/15-scraping-notes.html#html-structure",
    "title": "15 Web scraping",
    "section": "HTML structure",
    "text": "HTML structure\nHTML (hypertext markup language) is the formatting language used to create webpages. Let‚Äôs look at the core parts of HTML from the rvest vignette.\nKey HTML Concepts:\n\n\nElements which consist of a start tag (e.g.¬†&lt;tag&gt;) and end with an end tag (e.g.¬†&lt;/tag&gt;)\nOptional attributes (id='first') within the start tag\n\nContents of an element\n\nKey CSS Concepts:\n\nTo identify part of the html code, we can use the tag type (e.g.¬†&lt;a&gt;, &lt;h1&gt;, &lt;p&gt;) and class or id attributes.\nEach element can have a class attribute and/or an id attribute.\nWe can also identify parts of the code based on whether they are children or descendants of other elements, in that they are contained within an element. We won‚Äôt need this for simple applications.",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>11</span>¬† <span class='chapter-title'>15 Web scraping</span>"
    ]
  },
  {
    "objectID": "src/ica/15-scraping-notes.html#finding-css-selectors",
    "href": "src/ica/15-scraping-notes.html#finding-css-selectors",
    "title": "15 Web scraping",
    "section": "Finding CSS Selectors",
    "text": "Finding CSS Selectors\nIn order to gather information from a webpage, we must learn the language used to identify patterns of specific information. For example, on the NIH News Releases page, we can see that the data is represented in a consistent pattern of image + title + abstract.\nWe will identify data in a web page using a pattern matching language called CSS Selectors that can refer to specific patterns in HTML, the language used to write web pages.\nFor example:\n\nSelecting by element/tag type:\n\n\n\"a\" selects all hyperlinks in a webpage (‚Äúa‚Äù represents ‚Äúanchor‚Äù links in HTML)\n\n\"p\" selects all paragraph elements\n\n\nSelecting by class and ID:\n\n\n\".description\" selects all elements with class equal to ‚Äúdescription‚Äù\n\nThe . at the beginning is what signifies class selection.\nThis is one of the most common CSS selectors for scraping because in HTML, the class attribute is extremely commonly used to format webpage elements. (Any number of HTML elements can have the same class, which is not true for the id attribute.)\n\n\n\n\"#mainTitle\" selects the SINGLE element with id equal to ‚ÄúmainTitle‚Äù\n\nThe # at the beginning is what signifies id selection.\n\n\n\n\n\n&lt;p class=\"title\"&gt;Title of resource 1&lt;/p&gt;\n&lt;p class=\"description\"&gt;Description of resource 1&lt;/p&gt;\n\n&lt;p class=\"title\"&gt;Title of resource 2&lt;/p&gt;\n&lt;p class=\"description\"&gt;Description of resource 2&lt;/p&gt;\nWarning: Websites change often! So if you are going to scrape a lot of data, it is probably worthwhile to save and date a copy of the website (File &gt; Save As). Otherwise, you may return after some time and your scraping code will include all of the wrong CSS selectors.\nAlthough you can learn how to use CSS Selectors by hand (CSS Selectors), we will use a shortcut by installing the Selector Gadget tool.\n\nThere is a version available for Chrome‚Äìadd it to Chrome via the Chome Web Store.\n\nMake sure to pin the extension to the menu bar. (Click the 3 dots &gt; Extensions &gt; Manage extensions. Click the ‚ÄúDetails‚Äù button under SelectorGadget and toggle the ‚ÄúPin to toolbar‚Äù option.)\n\n\nThere is also a version that can be saved as a bookmark in the browser‚Äìsee here.\n\nLet‚Äôs watch the Selector Gadget tutorial video before proceeding.",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>11</span>¬† <span class='chapter-title'>15 Web scraping</span>"
    ]
  },
  {
    "objectID": "src/ica/15-scraping-notes.html#example-1-nih-new-releases",
    "href": "src/ica/15-scraping-notes.html#example-1-nih-new-releases",
    "title": "15 Web scraping",
    "section": "Example 1: NIH New Releases",
    "text": "Example 1: NIH New Releases\nHead over to the NIH News Releases page.\nClick the Selector Gadget extension icon or bookmark button.\nAs you mouse over the webpage, different parts will be highlighted in orange.\nClick on the title of the first news release.\nYou‚Äôll notice that the Selector Gadget information in the lower right describes what you clicked on.\nScroll through the page to verify that only the information you intend (the description paragraph) is selected.\n\nThe selector panel shows the CSS selector (.thumbnail-teaser__heading) and the number of matches for that CSS selector (10). (You may have to be careful with your clicking‚Äìthere are two overlapping boxes, and clicking on the link of the title can lead to the CSS selector of ‚Äúa‚Äù.)\n\nExercise: Repeat the process above to find the correct selectors for the following fields. Make sure that each matches 10 results:\n\nThe publication date\nThe article abstract paragraph (which will also include the publication date)",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>11</span>¬† <span class='chapter-title'>15 Web scraping</span>"
    ]
  },
  {
    "objectID": "src/ica/15-scraping-notes.html#retrieving-data-using-rvest-and-css-selectors",
    "href": "src/ica/15-scraping-notes.html#retrieving-data-using-rvest-and-css-selectors",
    "title": "15 Web scraping",
    "section": "Retrieving Data Using rvest and CSS Selectors",
    "text": "Retrieving Data Using rvest and CSS Selectors\nNow that we have identified CSS selectors for the information we need, let‚Äôs fetch the data using the rvest package.\n\nCode#install.packages(rvest)\nlibrary(rvest)\n\nnih &lt;- read_html(\"https://www.nih.gov/news-events/news-releases\")\n\n\nOnce the webpage is loaded, we can retrieve data using the CSS selectors we specified earlier. The following code retrieves the article titles:\n\nCode# Retrieve and inspect article titles\narticle_titles &lt;- nih |&gt;\n    html_elements(\".thumbnail-teaser__heading\") |&gt;\n    html_text()\nhead(article_titles)\n\n[1] \"Dr. Kyle Walsh selected to lead the National Institute of Environmental Health Sciences\"                   \n[2] \"HHS Doubles AI-Backed Childhood Cancer Research Funding\"                                                   \n[3] \"Secretary Kennedy Swears in Dr. Anthony Letai as Director of the National Cancer Institute\"                \n[4] \"NIH establishes nation's first dedicated organoid development center to reduce reliance on animal modeling\"\n[5] \"NIH launches $50M Autism Data Science Initiative to unlock causes and improve outcomes\"                    \n[6] \"Repeated head impacts cause early neuron loss and inflammation in young athletes\"                          \n\n\nExercise: Our goal is to get article titles, publication dates, and abstract text for news releases across several pages of results.\nBefore doing any coding, plan your approach.\n\nWhat functions will you write?\nWhat arguments will they have?\nHow will you use your functions?\n\nConsult with your peers and compare plans. &gt;\n\n\n\n\n\n\nStop to reflect\n\n\n\nWrite a few observations about your comfort/confidence in this planning exercise. As you proceed through the implementation of this plan in the next steps, make notes about any places you struggled, were uncertain, or benefited from peer input.\n\n\nExercise: Carry out your plan to get the article title, publication date, and abstract text for the first 5 pages of news releases in a single data frame. You will need to write at least one function, and you will need iteration‚ÄìStart with an appropriate map() function from purrr. If you have time, also try to use a for loop instead.\nNotes:\n\nMouse over the page buttons at the very bottom of the news home page to see what the URLs look like.\nThe abstract should not have the publication date‚Äìuse stringr and regular expressions to remove the publication date.\nIf the website has Crawl-delay: x in its robots.txt, include Sys.sleep(x) in your function to respect that.\nRecall that bind_rows() from dplyr and list_rbind() from purrr takes a list of data frames and stacks them on top of each other.\n\n\nCode# Helper function to reduce html_elements() |&gt; html_text() code duplication\n\nlibrary(tidyr)\nget_text_from_page &lt;- function(page, css_selector) {\n    page |&gt;\n        html_elements(css_selector) |&gt;\n        html_text()\n}\n\nscrape_page &lt;- function(url) {\n    Sys.sleep(2)\n    page &lt;- read_html(url)\n    article_titles &lt;- get_text_from_page(page, \".thumbnail-teaser__heading\")\n    article_dates_abstracts &lt;- get_text_from_page(page, \".thumbnail-teaser__description\")\n    \n    tibble(\n        title = article_titles,\n        date_abstract = article_dates_abstracts\n    ) |&gt; \n    separate_wider_delim(\n    delim = \" ‚Äî \", \n    cols = dates_abstract, \n    names = c(\"pub_date\", \"abstract\"))\n}\n\n\n\nCode# Create a character vector of URLs for the first 5 pages\n#library(purrr)\n#library(stringr)\n#library(rvest)\n#base_url &lt;- \"https://www.nih.gov/news-events/news-releases\"\n#urls_all_pages &lt;- c(base_url, str_c(base_url, \"?page=\", 1:4))\n\n#pages2 &lt;- purrr::map(urls_all_pages, scrape_page)\n#df_articles2 &lt;- bind_rows(pages2)\n#head(df_articles2)",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>11</span>¬† <span class='chapter-title'>15 Web scraping</span>"
    ]
  },
  {
    "objectID": "src/ica/15-scraping-notes.html#example-2-nih-stem-teaching-resources",
    "href": "src/ica/15-scraping-notes.html#example-2-nih-stem-teaching-resources",
    "title": "15 Web scraping",
    "section": "Example 2: NIH STEM Teaching Resources",
    "text": "Example 2: NIH STEM Teaching Resources\nLet‚Äôs look at a more complex example with the NIH STEM Teaching Resources webpage.\n\nUsing Selector Gadget to select the resource titles can be tricky if we can only get one resource title at a time.\nIn Chrome, you can right click part of a web page and click ‚ÄúInspect‚Äù. This opens up Chrome‚Äôs Developer Tools. Mousing over the HTML in the top right panel highlights the corresponding part of the web page.\n\nFor non-Chrome browsers, use the Help menu to search for Developer Tools.\n\n\n\nThe underlying HTML used to create a web page is also called the page source code or page source.\nWe learn from this that the resource titles are &lt;h4&gt; headings that have the class resource-title.\nWe can infer from this that .resource-title would be the CSS selector for the resource titles. ## Done!\n\nCheck the ICA Instructions for how to (a) push your code to GitHub and (b) update your portfolio website",
    "crumbs": [
      "In-Class Activities",
      "<span class='chapter-number'>11</span>¬† <span class='chapter-title'>15 Web scraping</span>"
    ]
  }
]